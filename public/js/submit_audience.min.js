$(document).ready(function(){var e=$("#submit_audience"),t=$("#upload-custom-audience"),o=$("#google_custom_audience"),a=$("#facebook_custom_audience"),s=$("#google-sync-status"),n=($("#facebook-sync-status"),$("#audience_name")),i=$("#filtered_audience_id").val(),c=$("#user_id").val(),r=function(e){var t=(new Date).getTime();return e=e.replace(/ /g,"_")+"_"+t},l=function(e,t,o){var a=!1;o.val()&&o.val().match(/^[a-zA-Z0-9 \_]*$/)&&(e.is(":checked")||t.is(":checked"))&&(a=!0),a?$("#submit_audience").prop("disabled",!1):$("#submit_audience").prop("disabled",!0)};$("#facebook_custom_audience").change(function(){l($("#google_custom_audience"),$("#facebook_custom_audience"),$("#audience_name"))}),$("#google_custom_audience").change(function(){l($("#google_custom_audience"),$("#facebook_custom_audience"),$("#audience_name"))}),$("#audience_name").keyup(function(){l($("#google_custom_audience"),$("#facebook_custom_audience"),$("#audience_name"))});var u=function(e){"google"==e?(s.show(),$("#google-sync-status .status-text").html("Syncing&nbsp;"),$.post("/api/meetpat-client/submit-audience/run-job-google",{user_id:c,filtered_audience_id:i},function(){}).fail(function(e){$("#google-sync-status .status-text").addClass("text-danger"),$("#google-sync-status .status-text").html('error&nbsp;<i class="far fa-times-circle"></i>'),$("#google-sync-status .status-loader").remove(),e.responseJSON.exception.message.includes("AuthenticationError")?$("#alert-container").append('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> An Authentication error has occured. Please make sure that your Adwords Account ID id correct.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'):e.responseJSON.exception.message.includes("QuotaCheckError")?$("#alert-container").append('<div class="alert alert-warning alert-dismissible fade show" role="alert"><strong>Error!</strong> Adwords resonded with a Quota Check Error please be sure that you are nor exceeding your account limitations.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'):e.responseJSON.exception.message.includes("CollectionSizeError")?$("#alert-container").append('<div class="alert alert-warning alert-dismissible fade show" role="alert"><strong>Error!</strong> Google Adwoeds responsed with error. There are too few customers in your list.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'):$("#alert-container").append('<div class="alert alert-warning alert-dismissible fade show" role="alert"><strong>Error!</strong> Something went wrong please contact MeetPAT for assistance.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),console.log(e)}).done(function(e){console.log(e),$("#google-sync-status .status-text").addClass("text-success"),$("#google-sync-status .status-text").html('complete&nbsp;<i class="fas fa-check-square"></i>'),$("#google-sync-status .status-loader").remove()})):console.log("Erro: Platform does not exist.")};e.click(function(){$("#submit_audience").prop("disabled",!0),$("#submit_audience").html(' <span class="spinner-border spinner-border-sm" style="margin-bottom: 4px;" role="status" aria-hidden="true"></span>&nbsp;Submitting Audience'),o=$("#google_custom_audience"),a=$("#facebook_custom_audience"),n=$("#audience_name").val(),o.is(":checked")?$.post("/api/meetpat-client/submit-audience/add-to-que",{user_id:c,filtered_audience_id:i,platform:"google",audience_name:r(n)},function(){}).fail(function(e){console.log(e)}).done(function(e){console.log(e),u("google"),$("#submit_audience").html("Done"),a.is(":checked")&&$.post("/api/meetpat-client/submit-audience/add-to-que",{user_id:c,filtered_audience_id:i,platform:"facebook",audience_name:r(n)},function(){}).fail(function(e){console.log(e)}).done(function(e){u("facebook"),console.log(e)}),t.hide()}):a.is(":checked")?$.post("/api/meetpat-client/submit-audience/add-to-que",{user_id:c,filtered_audience_id:i,platform:"facebook",audience_name:r(n)},function(){}).fail(function(e){console.log(e)}).done(function(e){console.log(e),u("facebook"),t.hide()}):console.log("error: no platform has been selected.")})});