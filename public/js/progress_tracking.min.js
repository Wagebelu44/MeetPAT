var get_percentage=function(e,r){return $percentage=r/e*100,Math.trunc($percentage)};$(document).ready(function(){var e=$("#user_id").val();$.post("/api/meetpat-client/get-job-que",{user_id:e},function(e){}).fail(function(e){console.log(e)}).done(function(e){for(var r in e.jobs)"done"==e.jobs[r].status?$("#records-status").append('<h5 class="card-title progress-title">'+e.jobs[r].audience_file.audience_name+'</h5><div class="progress" id="job_'+r+'"><div class="progress-bar progress-bar-striped progress-bar-animated bg-success" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">complete</div></div> <br />'):"pending"==e.jobs[r].status?$("#records-status").append('<h5 class="card-title progress-title" id="progress_title_'+r+'" style="display: none";>'+e.jobs[r].audience_file.audience_name+'</h5><div class="d-flex align-items-center loader_title mb-1" id="loader_title_'+r+'"><strong>'+e.jobs[r].audience_file.audience_name+'</strong><div class="spinner-border ml-auto spinner-border-sm" role="status" aria-hidden="true"></div></div><div class="progress" id="job_'+r+'"><div class="progress-bar progress-bar-striped progress-bar-animated bg-info" role="progressbar" style="width:'+get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+'%" aria-valuenow="'+get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+'" aria-valuemin="0" aria-valuemax="100">Pending...</div></div> <br /><p class="badge badge-pill badge-warning">Checking and removing duplicate records: <span id="recordsChecked_'+r+'">'+e.jobs[r].records_checked+"/"+e.jobs[r].records+"</span></p>"):$("#records-status").append('<h5 class="card-title progress-title" id="progress_title_'+r+'" style="display: none";>'+e.jobs[r].audience_file.audience_name+'</h5><div class="d-flex align-items-center loader_title mb-1" id="loader_title_'+r+'"><strong>'+e.jobs[r].audience_file.audience_name+'</strong><div class="spinner-border ml-auto spinner-border-sm" role="status" aria-hidden="true"></div></div><div class="progress" id="job_'+r+'"><div class="progress-bar progress-bar-striped progress-bar-animated bg-info" role="progressbar" style="width:'+get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+'%" aria-valuenow="'+get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+'" aria-valuemin="0" aria-valuemax="100">'+get_percentage(e.jobs[r].records,e.jobs[r].records_completed)+'%</div></div> <br /><p class="badge badge-pill badge-warning">Checking and removing duplicate records: <span id="recordsChecked_'+r+'">'+e.jobs[r].records_checked+"/"+e.jobs[r].records+"</span></p>");$("#status-loader").hide()}),window.setInterval(function(){$.post("/api/meetpat-client/get-job-que",{user_id:e},function(e){}).fail(function(e){console.log(e),window.clearInterval()}).done(function(e){for(var r in e.jobs)e.jobs[r].records!==e.jobs[r].records_completed&&"running"==e.jobs[r].status?($("#job_"+r+" .progress-bar").attr("aria-valuenow",get_percentage(e.jobs[r].records,e.jobs[r].records_checked)),$("#job_"+r+" .progress-bar").html(get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+"%"),$("#job_"+r+" .progress-bar").width(get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+"%")):"done"==e.jobs[r].status&&($("#loader_title_"+r).remove(),$("#progress_title_"+r).show(),$("#job_"+r+" .progress-bar").attr("aria-valuenow",get_percentage(e.jobs[r].records,e.jobs[r].records_checked)),$("#job_"+r+" .progress-bar").html("complete"),$("#job_"+r+" .progress-bar").width(get_percentage(e.jobs[r].records,e.jobs[r].records_checked)+"%"),$("#job_"+r+" .progress-bar").removeClass("bg-info"),$("#job_"+r+" .progress-bar").removeClass("progress-bar-animated"),$("#job_"+r+" .progress-bar").addClass("bg-success")),$("#recordsChecked_"+r).html(e.jobs[r].records_checked+"/"+e.jobs[r].records);0==e.jobs_running&&(window.clearInterval(),$("#loader").css("display","block"),window.location="/meetpat-client/data-visualisation")})},3e3)});