var edit_file=function(e){$("#input_"+e).attr("readonly")?$("#input_"+e).removeAttr("readonly"):$("#input_"+e).attr("readonly",!0)},delete_file=function(e,a){var t=$("#paginationContainer").attr("data-current-page"),r=$("#paginationContainer").attr("data-number-of-pages"),o=confirm("Are you sure that you want to delete: "+a+"?"),i=function(){$(".page-item").removeClass("disabled"),1==t&&($("#btn_prev_item").hasClass("disabled")||document.getElementById("btn_prev_item").classList.add("disabled")),t==r&&($("#btn_next_item").hasClass("disabled")||document.getElementById("btn_next_item").classList.add("disabled"))};$(".delete_file_btn").prop("disabled",!0),$(".page-item").addClass("disabled"),1==o?($("#delete_"+e).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span><span class="sr-only">Loading...</span>'),$.post("/api/meetpat-client/delete-saved-audience-file",{user_id:user_id_number,file_unique_name:e},function(a){$("#file_name_"+e).remove(),$("#file_actions_"+e).remove()}).fail(function(a){$("#delete_"+e).html('<i class="fas fa-trash-alt"></i>'),$(".delete_file_btn").prop("disabled",!1),i(),console.log(a)}).done(function(){$("#delete_"+e).html('<i class="fas fa-trash-alt"></i>'),$(".delete_file_btn").prop("disabled",!1),i(),get_saved_audiences()})):($(".delete_file_btn").prop("disabled",!1),i())};$(document).ready(function(){function e(e){return e=e.charAt(0).toUpperCase()+e.slice(1)}google.charts.load("current",{packages:["corechart","geochart","bar"],mapsApiKey:"AIzaSyBMae5h5YHUJ1BdNHshwj_SmJzPe5mglwI"});var a=function(e){return"True"==e||"true"==e?"Yes":"False"==e||"false"==e?"No":e},t=function(e){return"True"==e||"true"==e?"Owns Vehicle":"False"==e||"false"==e?"Unknown":e},r=function(e){switch(e){case"R0 - R2 500":return"R0K - R2.5K";case"R2 500 - R5 000":return"R2.5K - R5K";case"R5 000 - R10 000":return"R5K - R10K";case"R10 000 - R20 000":return"R10K - R20K";case"R20 000 - R30 000":return"R20K - R30K";case"R30 000 - R40 000":return"R30K - R40K";case"R40 000 +":return"R40K +";default:return"Unknown"}},o=function(e){switch(e){case"M":return"Male";case"F":return"Female";default:return"Unknown"}},i=function(e){return"True"==e||"true"==e?"Married":"False"==e||"false"==e?"Not Married":e},n=function(e){var a;switch(e){case"G":a="Gauteng";break;case"WC":a="Western Cape";break;case"EC":a="Eastern Cape";break;case"M":a="Mpumalanga";break;case"NW":a="North West";break;case"FS":a="Free State";break;case"L":a="Limpopo";break;case"KN":a="KwaZulu Natal";break;case"NC":a="Northern Cape";break;default:a="Unknown"}return a},l=function(e){switch(e){case"G":0==--K&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"WC":0==--W&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"EC":0==--Y&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"M":0==--q&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"NW":0==--U&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"FS":0==--Z&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"L":0==--J&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"KN":0==--V&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"NC":0==--H&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove())}},c=function(e,a){if(province_code_array=["G","WC","KN","M","EC","FS","NC","NW","L"],province_code_array.includes(e))switch($("#"+e.toLowerCase()+"_option").is(":checked")||$("#"+e.toLowerCase()+"_option").prop("checked",!0),e){case"G":a||0==K?1==++K&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()})):0==--K&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"WC":a||0==W?1==++W&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()})):0==--W&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"KN":a||0==V?1==++V&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()})):0==--V&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"M":a||0==q?1==++q&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()})):0==--q&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"EC":a||0==Y?1==++Y&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()})):0==--Y&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"FS":a||0==Z?1==++Z&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()})):0==--Z&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"NC":a||0==H?(H++,1==K&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()}))):0==--H&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"NW":a||0==U?(U++,1==K&&0==$("#filter_p_"+e.toLowerCase()).length&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()}))):0==--U&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove());break;case"L":a||0==J?(J++,1==K&&$("#filter_p_"+e.toLowerCase())&&($("#province_filters").append('<li id="filter_p_'+e.toLowerCase()+'">'+n(e)+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+e.toLowerCase()+" i").click(function(){$("#"+e.toLowerCase()+"_option").length&&($("#filter_p_"+e.toLowerCase()).remove(),$("#"+e.toLowerCase()+"_option").prop("checked",!1)),Q()}))):0==--J&&($("#"+e.toLowerCase()+"_option").prop("checked",!1),$("#filter_p_"+e.toLowerCase())&&$("#filter_p_"+e.toLowerCase()).remove())}},s=function(){$("#sidebar-toggle-button").hasClass("sidebar-button-in")?$("#sidebar-toggle-button").html('<i class="fas fa-arrow-right"></i>'):$("#sidebar-toggle-button").html('<i class="fas fa-cog"></i>'),$("#right-options-sidebar").toggleClass("sidebar-in"),$("#sidebar-toggle-button").toggleClass("sidebar-button-in")},p=0,_=function(){19!=p&&p++,$("#progress_popup .progress-bar").width(Math.round(p/19*100)+"%"),$("#progress_popup .progress-bar").attr("aria-valuenow",Math.round(p/19*100))},d=function(){setTimeout(function(){$("#progress_popup").hide()},1e3),$("#sidebar-toggle-button").hasClass("sidebar-button-in")&&($("#sidebar-toggle-button").html('<i class="fas fa-arrow-right"></i>'),$("#right-options-sidebar").toggleClass("sidebar-in"),$("#sidebar-toggle-button").toggleClass("sidebar-button-in"))},h=$("#user_id").val(),u=$("#user_auth_token").val(),g="all_records",f=1,m=5;function v(e,a){var t=document.getElementById("userSavedFiles"),r=document.getElementById("page_span");e<1&&(e=1),e>w(a)&&(e=w(a)),t.innerHTML="";for(var o=(e-1)*m;o<e*m&&o<a.length;o++)$("#userSavedFiles").length&&a.length&&(audience_file=a[o],audience_file.link,$("#userSavedFiles").append(`<div class="col-7 col-sm-9 col-md-9 mb-1" id="file_name_${audience_file.file_unique_name}"><input id="input_${audience_file.file_unique_name}" class="form-control" name="${audience_file.file_unique_name}" value="${audience_file.file_name}" readonly></div><div class="col-5 col-sm-3 col-md-3 mb-1" id="file_actions_${audience_file.file_unique_name}"><div class="btn-group float-right" role="group" aria-label="Basic example"><button type="button" id="edit_${audience_file.file_unique_name}" onclick="edit_file('${audience_file.file_unique_name}')" class="btn btn-light"><i class="far fa-edit"></i></button><button type="button" id="delete_${audience_file.file_unique_name}" onclick="delete_file('${audience_file.file_unique_name}','${audience_file.file_name}');" class="btn btn-danger delete_file_btn"><i class="fas fa-trash-alt"></i></button></div></div>`));a.forEach(function(e){0==$("#input_"+e.file_unique_name).length&&(e.link,$("#userSavedFiles").append(`<div class="col-7 col-sm-9 col-md-9 mb-1 d-none" id="file_name_${e.file_unique_name}"><input id="input_${e.file_unique_name}" class="form-control" name="${e.file_unique_name}" value="${e.file_name}" readonly></div><div class="col-5 col-sm-3 col-md-3 mb-1 d-none" id="file_actions_${e.file_unique_name}"><div class="btn-group float-right" role="group" aria-label="Basic example"><button type="button" id="edit_${e.file_unique_name}" onclick="edit_file('${e.file_unique_name}')" class="btn btn-light"><i class="far fa-edit"></i></button><button type="button" id="delete_${e.file_unique_name}" onclick="delete_file('${e.file_unique_name}','${e.file_name}');" class="btn btn-danger delete_file_btn"><i class="fas fa-trash-alt"></i></button></div></div>`))}),$(".page-item").removeClass("disabled"),1==e&&($("#btn_prev_item").hasClass("disabled")||document.getElementById("btn_prev_item").classList.add("disabled")),e==w(a)&&($("#btn_next_item").hasClass("disabled")||document.getElementById("btn_next_item").classList.add("disabled")),r.innerHTML=e+" of "+w(a),$("#paginationContainer").attr("data-current-page",e),$("#paginationContainer").attr("data-number-of-pages",w(a))}function w(e){return Math.ceil(e.length/m)}var b=[],C=[],L=[],k=[],y=[],x=[],S=[],A=[],I=[],B=[],z=[],T=[],E=[],N=[],R=[],G=[],O=[],M=[],j=[],F=[],D=[],P=[],K=0,W=0,V=0,q=0,Y=0,Z=0,H=0,U=0,J=0,Q=function(){var e=document.getElementById("province_filters"),a=document.getElementById("municipality_filters"),t=document.getElementById("area_filters"),r=document.getElementById("age_filters"),o=document.getElementById("gender_filters"),i=document.getElementById("population_group_filters"),n=document.getElementById("generation_filters"),l=document.getElementById("citizen_vs_resident_filters"),c=document.getElementById("marital_status_filters"),s=document.getElementById("home_owner_filters"),p=document.getElementById("risk_category_filters"),_=document.getElementById("household_income_filters"),d=document.getElementById("directors_filters"),h=document.getElementById("vehicle_owner_filters"),u=document.getElementById("lsm_group_filters"),g=document.getElementById("property_valuation_filters"),f=document.getElementById("property_count_bucket_filters"),m=document.getElementById("primary_property_type_filters"),v=document.getElementById("branch_filters"),w=document.getElementById("campaign_filters"),b=document.getElementById("source_filters"),C=document.getElementById("other_filters");e.childNodes.length>1||a.childNodes.length>1||t.childNodes.length>1||r.childNodes.length>1||o.childNodes.length>1||i.childNodes.length>1||n.childNodes.length>1||l.childNodes.length>1||c.childNodes.length>1||s.childNodes.length>1||p.childNodes.length>1||_.childNodes.length>1||d.childNodes.length>1||h.childNodes.length>1||u.childNodes.length>1||g.childNodes.length>1||f.childNodes.length>1||m.childNodes.length>1||v.childNodes.length>1||w.childNodes.length>1||b.childNodes.length>1||C.childNodes.length>1?$("#no_filters").hide():$("#no_filters").show(),e.childNodes.length>1?$("#province_filters").show():$("#province_filters").hide(),a.childNodes.length>1?$("#municipality_filters").show():$("#municipality_filters").hide(),t.childNodes.length>1?$("#area_filters").show():$("#area_filters").hide(),r.childNodes.length>1?$("#age_filters").show():$("#age_filters").hide(),o.childNodes.length>1?$("#gender_filters").show():$("#gender_filters").hide(),i.childNodes.length>1?$("#population_group_filters").show():$("#population_group_filters").hide(),n.childNodes.length>1?$("#generation_filters").show():$("#generation_filters").hide(),l.childNodes.length>1?$("#citizen_vs_resident_filters").show():$("#citizen_vs_resident_filters").hide(),c.childNodes.length>1?$("#marital_status_filters").show():$("#marital_status_filters").hide(),s.childNodes.length>1?$("#home_owner_filters").show():$("#home_owner_filters").hide(),p.childNodes.length>1?$("#risk_category_filters").show():$("#risk_category_filters").hide(),_.childNodes.length>1?$("#household_income_filters").show():$("#household_income_filters").hide(),d.childNodes.length>1?$("#directors_filters").show():$("#directors_filters").hide(),h.childNodes.length>1?$("#vehicle_owner_filters").show():$("#vehicle_owner_filters").hide(),u.childNodes.length>1?$("#lsm_group_filters").show():$("#lsm_group_filters").hide(),g.childNodes.length>1?$("#property_valuation_filters").show():$("#property_valuation_filters").hide(),f.childNodes.length>1?$("#property_count_bucket_filters").show():$("#property_count_bucket_filters").hide(),m.childNodes.length>1?$("#primary_property_type_filters").show():$("#primary_property_type_filters").hide(),v.childNodes.length>1?$("#branch_filters").show():$("#branch_filters").hide(),w.childNodes.length>1?$("#campaign_filters").show():$("#campaign_filters").hide(),b.childNodes.length>1?$("#source_filters").show():$("#source_filters").hide(),C.childNodes.length>1?$("#other_filters").show():$("#other_filters").hide()};function X(e){var a,t=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(a=t.length-1;a>0&&!(e>=t[a].value);a--);return(e/t[a].value).toFixed(1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+t[a].symbol}function ee(){data={user_id:h,filter_type:g,api_token:u},$.ajax({url:"/api/meetpat-client/get-location-data",type:"GET",data:data,success:function(e){var a=$("#records-main-toast .toast-body"),t=$("#records-toast .toast-body"),r=$("#contacts-num-sidebar"),o=$("#numberOfContactsId"),i=$("#eta_file_process");for(var s in a.html(X(e.count[0].count)),r.html(X(e.count[0].count)),t.html(X(e.count[0].count)),o.val(e.count[0].count),e.count[0].count<1e5?i.html("30 seconds"):e.count[0].count>1e5&&e.count[0].count<3e5?i.html("a minute"):i.html("a few minutes"),$("#contacts-number .spinner-block").hide(),$("#province_filter").empty(),e.provinces_distinct)b.includes(e.provinces_distinct[s].province)?$("#province_filter").append('<input type="checkbox" name="'+e.provinces_distinct[s].province+'" id="'+e.provinces_distinct[s].province.toLowerCase()+'_option" value="'+e.provinces_distinct[s].province+'" class="css-checkbox" checked="checked"><label for="'+e.provinces_distinct[s].province.toLowerCase()+'_option" class="css-label">'+n(e.provinces_distinct[s].province)+"</label><br />"):$("#province_filter").append('<input type="checkbox" name="'+e.provinces_distinct[s].province+'" id="'+e.provinces_distinct[s].province.toLowerCase()+'_option" value="'+e.provinces_distinct[s].province+'" class="css-checkbox"><label for="'+e.provinces_distinct[s].province.toLowerCase()+'_option" class="css-label">'+n(e.provinces_distinct[s].province)+"</label><br />"),$("#"+e.provinces_distinct[s].province.toLowerCase()+"_option").click(function(){if($("#"+$(this).attr("name").toLowerCase()+"_option").is(":checked")){var e=this;$("#province_filters").append('<li id="filter_p_'+$(this).attr("name").toLowerCase()+'">'+n($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+$(this).val().toLowerCase()+" i").click(function(){$("#"+$(e).val().toLowerCase()+"_option").length&&($("#filter_p_"+$(e).val().toLowerCase()).remove(),$("#"+$(e).val().toLowerCase()+"_option").prop("checked",!1)),Q()})}else $("#filter_p_"+$(this).val().toLowerCase())&&$("#filter_p_"+$(this).val().toLowerCase()).remove();Q()});chart_data_province=e.provinces,$("#map-graph .spinner-block").hide();var p=Object.keys(chart_data_province).map(function(e){var a;switch(chart_data_province[e].province){case"G":a=["ZA-GT",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Gauteng</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"WC":a=["ZA-WC",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Western Cape</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"EC":a=["ZA-EC",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Eastern Cape</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"M":a=["ZA-MP",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Mpumalanga</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"FS":a=["ZA-FS",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Free State</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"L":a=["ZA-LP",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Limpopo</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"KN":a=["ZA-NL",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>KwaZula Natal</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"NW":a=["ZA-NW",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>North West Province</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;case"NC":a=["ZA-NC",chart_data_province[e].audience,'<ul class="list-unstyled"><li><b>Northern Cape</b></li><li>'+X(chart_data_province[e].audience)+"</li></ul>"];break;default:a=""}return a});p.unshift(["Provinces","Popularity",{role:"tooltip",p:{html:!0}}]);var d=p.filter(function(e){return""!=e}),h=google.visualization.arrayToDataTable(d);new google.visualization.GeoChart(document.getElementById("chartdiv")).draw(h,{region:"ZA",resolution:"provinces",backgroundColor:"#f7f7f7",colorAxis:{colors:["#039be5"]},tooltip:{isHtml:!0}}),_(),$("#province-graph .spinner-block").hide();var u=new google.visualization.DataTable;u.addColumn("string","Province"),u.addColumn("number","Records"),u.addColumn({type:"string",role:"annotation"});var g=Object.keys(chart_data_province).map(function(e){var a;switch(chart_data_province[e].province){case"G":a=["Gauteng",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"EC":a=["Eastern Cape",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"NC":a=["Northern Cape",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"FS":a=["Free State",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"L":a=["Limpopo",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"KN":a=["KwaZulu Natal",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"M":a=["Mpumalanga",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"NW":a=["North West",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;case"WC":a=["Western Cape",chart_data_province[e].audience,X(chart_data_province[e].audience)];break;default:a=[chart_data_province[e].province,chart_data_province[e].audience,X(chart_data_province[e].audience)]}return a});u.addRows(g);new google.visualization.BarChart(document.getElementById("provincesChart")).draw(u,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},legend:{position:"none"},backgroundColor:"#f7f7f7",colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"}}),_(),$("#municipality-graph .spinner-block").hide(),$("#municipality_filter").empty();var f=new google.visualization.DataTable;f.addColumn("string","Municipality"),f.addColumn("number","Records"),f.addColumn({type:"string",role:"annotation"});var m=e.municipalities,v=Object.keys(m).map(function(e){return[m[e].municipality,m[e].audience,X(m[e].audience)]});if(f.addRows(v),v.length>10)var w={height:25*v.length,width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};else w={width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};e.municipality_distinct.forEach(function(e){C.includes(e.municipality)?$("#municipality_filter").append('<input type="checkbox" name="'+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'" id="municipality_'+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" value="'+e.municipality+'" class="css-checkbox" checked="checked"><label for="municipality_'+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" class="css-label">'+e.municipality+" ("+e.province+") </label><br />"):$("#municipality_filter").append('<input type="checkbox" name="'+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'" id="municipality_'+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" value="'+e.municipality+'" class="css-checkbox"><label for="municipality_'+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" class="css-label">'+e.municipality+" ("+e.province+") </label><br />"),$("#municipality_"+e.municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").click(function(){if($("#municipality_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").is(":checked")){c(e.province,!0);var a=this;$("#municipality_filters").append('<li id="filter_municipality_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_municipality_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+" i").click(function(){$("#municipality_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").length&&($("#filter_municipality_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")).remove(),$("#municipality_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").prop("checked",!1)),l(e.province),Q()})}else c(e.province,!1),$("#filter_municipality_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_"))&&$("#filter_municipality_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")).remove();Q()})}),new google.visualization.BarChart(document.getElementById("municipalityChart")).draw(f,w),_(),$("#area-graph .spinner-block").hide(),$("#areaSubmitBtn").prop("disabled",!1),$("#area_filter").append('<div id="lunr-search" style="display: none;"><div class="input-group mb-2"><div class="input-group-prepend"><div class="input-group-text"><i class="fas fa-search"></i></div></div><input type="text" class="form-control" id="areaSearchInput" placeholder="search for areas"></div><ul id="lunr-results" class="list-unstyled"></ul></div>');var L=new google.visualization.DataTable;L.addColumn("string","Area"),L.addColumn("number","Records"),L.addColumn({type:"string",role:"annotation"});var k=Object.keys(e.areas).map(function(a){return[e.areas[a].area,e.areas[a].audience,X(e.areas[a].audience)]}).slice(0,20);if(L.addRows(k),k.length>10)var y={width:"100%",height:25*k.length,fontSize:10,chartArea:{top:"20",top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],legend:{position:"none"},backgroundColor:"#f7f7f7"};else y={width:"100%",fontSize:10,chartArea:{top:"20",top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],legend:{position:"none"},backgroundColor:"#f7f7f7"};new google.visualization.BarChart(document.getElementById("areasChart")).draw(L,y);var x=Object.keys(e.areas_distinct).map(function(a){return{name:e.areas_distinct[a].area,province:e.areas_distinct[a].province,municipality:e.areas_distinct[a].municipality,count:X(e.areas_distinct[a].audience)}}),S=[];x.forEach(function(e){S.includes(e.municipality)||S.push(e.municipality)});var A=Object.keys(S).map(function(e){return{name:S[e],format_name:S[e].toLowerCase().replace(/ /g,"_").replace(/\./g,"_"),count:0}}),I=function(e){var a=A.filter(a=>{if(a.name===e)return a}).map(function(e){return e});a[0].count--,0==a[0].count&&($("#municipality_"+a[0].format_name.toLowerCase()+"_option").prop("checked",!1),$("#filter_municipality_"+a[0].format_name)&&$("#filter_municipality_"+a[0].format_name).remove()),Q()},B=function(e,a){var t=A.filter(a=>{if(a.name===e)return a}).map(function(e){return e});$("#municipality_"+t[0].format_name+"_option").is(":checked")||$("#municipality_"+t[0].format_name+"_option").prop("checked",!0),a||0==t[0].count?(t[0].count++,1==t[0].count&&0==$("#filter_municipality_"+t[0].format_name).length&&($("#municipality_filters").append('<li id="filter_municipality_'+t[0].format_name+'">'+t[0].format_name+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_municipality_"+t[0].format_name+" i").click(function(){$("#municipality_"+t[0].format_name+"_option").length&&($("#filter_municipality_"+t[0].format_name).remove(),$("#municipality_"+t[0].format_name+"_option").prop("checked",!1)),0==t[0].count&&($("#municipality_"+t[0].format_name+"_option").prop("checked",!1),$("#filter_municipality_"+t[0].format_name)&&$("#filter_municipality_"+t[0].format_name).remove()),Q()}))):(t[0].count--,0==t[0].count&&($("#municipality_"+t[0].format_name+"_option").prop("checked",!1),$("#filter_municipality_"+t[0].format_name)&&$("#filter_municipality_"+t[0].format_name).remove()))};$("#hidden-area-filter-form input").serializeArray().forEach(function(e){x.filter(a=>{a.name===e.value&&A.filter(e=>{e.name==a.municipality&&e.count++})})});var z=x,T=lunr(function(){this.ref("name"),this.field("name"),this.k1(1.5),this.b(.25),z.forEach(function(e){this.add(e)},this)});$("#lunr-search").show(),$("#area-filter-form .text-center").remove(),k.forEach(function(e){$("#area_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small> ("+n(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0])+")</label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!0),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!0);var a=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#area_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),l(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0]),I(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0]),Q()})}else c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!1),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!1),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small> ("+n(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0])+")</label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!0),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!0);var a=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#area_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),l(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0]),I(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0]),Q()})}else c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!1),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!1),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}),document.getElementById("areaSearchInput").addEventListener("keyup",function(){T.search(this.value+"*").length&&""!=this.value?($("#lunr-results").empty(),T.search(this.value+"*").forEach(function(e){e.score&&($("#area_hidden_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox" checked="checked"><label for="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+x.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small> ("+n(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0])+")</label><br />"),$("#area_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){c(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0],!0),B(x.filter(a=>{if(a.name===e.ref)return a.municipality}).map(function(e){return e.municipality})[0],!0);var a=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#area_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),l(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0]),I(x.filter(a=>{if(a.name===e.ref)return a.municipality}).map(function(e){return e.municipality})[0]),Q()})}else c(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0],!1),B(x.filter(a=>{if(a.name===e.ref)return a.municipality}).map(function(e){return e.municipality})[0],!1),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox"><label for="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+x.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small> ("+n(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0])+")</label><br />"),$("#area_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){c(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0],!0),B(x.filter(a=>{if(a.name===e.ref)return a.municipality}).map(function(e){return e.municipality})[0],!0);var a=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#area_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),l(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0]),I(x.filter(a=>{if(a.name===e.ref)return a.municipality}).map(function(e){return e.municipality})[0]),Q()})}else c(x.filter(a=>{if(a.name===e.ref)return a.province}).map(function(e){return e.province})[0],!1),B(x.filter(a=>{if(a.name===e.ref)return a.municipality}).map(function(e){return e.municipality})[0],!1),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})))})):($("#lunr-results").empty(),k.forEach(function(e){$("#area_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small> ("+n(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0])+")</label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!0),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!0);var a=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#area_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),l(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0]),I(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0]),Q()})}else c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!1),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!1),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small> ("+n(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0])+")</label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!0),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!0);var a=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#area_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#area_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),l(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0]),I(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0]),Q()})}else c(x.filter(a=>{if(a.name===e[0])return a.province}).map(function(e){return e.province})[0],!1),B(x.filter(a=>{if(a.name===e[0])return a.municipality}).map(function(e){return e.municipality})[0],!1),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}))}),_()}}).done(function(){data={user_id:h,filter_type:g,api_token:u},$.ajax({url:"/api/meetpat-client/get-demographic-data",type:"GET",data:data,success:function(e){$("#age-graph .spinner-block").hide(),$("#age_filter").empty();var a=new google.visualization.DataTable;a.addColumn("string","Age"),a.addColumn("number","Records"),a.addColumn({type:"string",role:"annotation"});var t=Object.keys(e.ages).map(function(a){return[ae(e.ages[a].ageGroup),e.ages[a].audience,X(e.ages[a].audience)]});for(var r in a.addRows(t),e.ages_distinct)k.includes(e.ages_distinct[r].ageGroup)?$("#age_filter").append('<input type="checkbox" name="'+e.ages_distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'" id="age_'+e.ages_distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" value="'+e.ages_distinct[r].ageGroup+'" class="css-checkbox" checked="checked"><label for="age_'+e.ages_distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" class="css-label">'+ae(e.ages_distinct[r].ageGroup)+"</label><br />"):$("#age_filter").append('<input type="checkbox" name="'+e.ages_distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'" id="age_'+e.ages_distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" value="'+e.ages_distinct[r].ageGroup+'" class="css-checkbox"><label for="age_'+e.ages_distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" class="css-label">'+ae(e.ages_distinct[r].ageGroup)+"</label><br />"),$("#age_"+e.ages_distinct[r].ageGroup.toLowerCase()+"_option").click(function(){if($("#age_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus")+"_option").is(":checked")){var e=this;$("#age_filters").append('<li id="filter_age_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus")+'">'+ae($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_age_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus")+" i").click(function(){$("#age_"+$(e).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus")+"_option").length&&($("#filter_age_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("+","plus")).remove(),$("#age_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("+","plus")+"_option").prop("checked",!1)),Q()})}else $("#filter_age_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus"))&&$("#filter_age_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus")).remove();Q()});var n=new google.visualization.BarChart(document.getElementById("agesChart"));n.draw(a,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_();var l=function(e){var a;switch(e){case"M":a="Male";break;case"F":a="Female";break;default:a="Unkown"}return a};$("#gender-graph .spinner-block").hide(),$("#gender_filter").empty();var c=new google.visualization.DataTable;c.addColumn("string","Gender"),c.addColumn("number","Records"),c.addColumn({type:"string",role:"annotation"});var s=Object.keys(e.genders).map(function(a){return[o(e.genders[a].gender),e.genders[a].audience,X(e.genders[a].audience)]});for(var r in c.addRows(s),e.genders_distinct)y.includes(e.genders_distinct[r].gender)?$("#gender_filter").append('<input type="checkbox" name="g_'+e.genders_distinct[r].gender+'" id="g_'+e.genders_distinct[r].gender.toLowerCase()+'_option" value="'+e.genders_distinct[r].gender+'" class="css-checkbox" checked="checked"><label for="g_'+e.genders_distinct[r].gender.toLowerCase()+'_option" class="css-label">'+l(e.genders_distinct[r].gender)+"</label><br />"):$("#gender_filter").append('<input type="checkbox" name="g_'+e.genders_distinct[r].gender+'" id="g_'+e.genders_distinct[r].gender.toLowerCase()+'_option" value="'+e.genders_distinct[r].gender+'" class="css-checkbox"><label for="g_'+e.genders_distinct[r].gender.toLowerCase()+'_option" class="css-label">'+l(e.genders_distinct[r].gender)+"</label><br />"),$("#g_"+e.genders_distinct[r].gender.toLowerCase()+"_option").click(function(){if($("#g_"+$(this).val().toLowerCase()+"_option").is(":checked")){var e=this;$("#gender_filters").append('<li id="filter_g_'+$(this).val().toLowerCase()+'">'+l($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_g_"+$(this).val().toLowerCase()+" i").click(function(){$("#g_"+$(e).val().toLowerCase()+"_option").length&&($("#filter_g_"+$(e).val().toLowerCase()).remove(),$("#g_"+$(e).val().toLowerCase()+"_option").prop("checked",!1)),Q()})}else $("#filter_g_"+$(this).val().toLowerCase())&&$("#filter_g_"+$(this).val().toLowerCase()).remove();Q()});var p=new google.visualization.ColumnChart(document.getElementById("genderChart"));p.draw(c,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_();var d=function(e){switch(e){case"B":return"Black";case"W":return"Caucasian";case"C":return"Coloured";case"A":return"Asian/Indian";default:return"Unkown"}};$("#population-graph .spinner-block").hide(),$("#population_group_filter").empty();var h=new google.visualization.DataTable;h.addColumn("string","Group"),h.addColumn("number","Records"),h.addColumn({type:"string",role:"annotation"});var u=Object.keys(e.population_groups).map(function(a){return[d(e.population_groups[a].populationGroup),e.population_groups[a].audience,X(e.population_groups[a].audience)]});for(var r in h.addRows(u),e.population_groups_distinct)x.includes(e.population_groups_distinct[r].populationGroup)?$("#population_group_filter").append('<input type="checkbox" name="pop_'+e.population_groups_distinct[r].populationGroup+'" id="pop_'+e.population_groups_distinct[r].populationGroup.toLowerCase()+'_option" value="'+e.population_groups_distinct[r].populationGroup+'" class="css-checkbox" checked="checked"><label for="pop_'+e.population_groups_distinct[r].populationGroup.toLowerCase()+'_option" class="css-label">'+d(e.population_groups_distinct[r].populationGroup)+"</label><br />"):$("#population_group_filter").append('<input type="checkbox" name="pop_'+e.population_groups_distinct[r].populationGroup+'" id="pop_'+e.population_groups_distinct[r].populationGroup.toLowerCase()+'_option" value="'+e.population_groups_distinct[r].populationGroup+'" class="css-checkbox"><label for="pop_'+e.population_groups_distinct[r].populationGroup.toLowerCase()+'_option" class="css-label">'+d(e.population_groups_distinct[r].populationGroup)+"</label><br />"),$("#pop_"+e.population_groups_distinct[r].populationGroup.toLowerCase()+"_option").click(function(){if($("#pop_"+$(this).val().toLowerCase()+"_option").is(":checked")){var e=this;$("#population_group_filters").append('<li id="filter_pop_'+$(this).val().toLowerCase()+'">'+d($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_pop_"+$(this).val().toLowerCase()+" i").click(function(){$("#pop_"+$(e).val().toLowerCase()+"_option").length&&($("#filter_pop_"+$(e).val().toLowerCase()).remove(),$("#pop_"+$(e).val().toLowerCase()+"_option").prop("checked",!1)),Q()})}else $("#filter_pop_"+$(this).val().toLowerCase())&&$("#filter_pop_"+$(this).val().toLowerCase()).remove();Q()});var g=new google.visualization.ColumnChart(document.getElementById("populationGroupChart"));g.draw(h,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#generation-graph .spinner-block").hide(),$("#generation_filter").empty();var f=new google.visualization.DataTable;f.addColumn("string","Generation"),f.addColumn("number","Records"),f.addColumn({type:"string",role:"annotation"});var m=Object.keys(e.generations).map(function(a){return[e.generations[a].generation,e.generations[a].audience,X(e.generations[a].audience)]});for(var r in f.addRows(m),e.generations_distinct)S.includes(e.generations_distinct[r].generation)?$("#generation_filter").append('<input type="checkbox" name="gen_'+e.generations_distinct[r].generation+'" id="gen_'+e.generations_distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" value="'+e.generations_distinct[r].generation+'" class="css-checkbox" checked="checked"><label for="gen_'+e.generations_distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" class="css-label">'+e.generations_distinct[r].generation+"</label><br />"):$("#generation_filter").append('<input type="checkbox" name="gen_'+e.generations_distinct[r].generation+'" id="gen_'+e.generations_distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" value="'+e.generations_distinct[r].generation+'" class="css-checkbox"><label for="gen_'+e.generations_distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" class="css-label">'+e.generations_distinct[r].generation+"</label><br />"),$("#gen_"+e.generations_distinct[r].generation.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#gen_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#generation_filters").append('<li id="filter_gen_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_gen_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#gen_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_gen_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#gen_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_gen_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_gen_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});var v=new google.visualization.ColumnChart(document.getElementById("generationChart"));v.draw(f,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#c-vs-r-graph .spinner-block").hide(),$("#citizen_vs_resident_filter").empty();var w=new google.visualization.DataTable;w.addColumn("string","Citizen or Resident"),w.addColumn("number","Records"),w.addColumn({type:"string",role:"annotation"});var b=Object.keys(e.citizens_vs_residents).map(function(a){return[e.citizens_vs_residents[a].citizenshipIndicator,e.citizens_vs_residents[a].audience,X(e.citizens_vs_residents[a].audience)]});w.addRows(b),A.includes("Citizen")?$("#citizen_vs_resident_filter").append('<input type="checkbox" name="citizen" id="citizen_option" value="Citizen" class="css-checkbox" checked="checked"><label for="citizen_option" class="css-label">Citizen</label><br />'):$("#citizen_vs_resident_filter").append('<input type="checkbox" name="citizen" id="citizen_option" value="Citizen" class="css-checkbox"><label for="citizen_option" class="css-label">Citizen</label><br />'),A.includes("Resident")?$("#citizen_vs_resident_filter").append('<input type="checkbox" name="resident" id="resident_option" value="Resident" class="css-checkbox" checked="checked"><label for="resident_option" class="css-label">Resident</label><br />'):$("#citizen_vs_resident_filter").append('<input type="checkbox" name="resident" id="resident_option" value="Resident" class="css-checkbox"><label for="resident_option" class="css-label">Resident</label><br />'),$("#citizen_option").click(function(){$("#citizen_option").is(":checked")?($("#citizen_vs_resident_filters").append('<li id="filter_citizen_option">Citizen<i class="fas fa-window-close float-right"></i></li>'),$("#filter_citizen_option i").click(function(){$("#filter_citizen_option")&&($("#filter_citizen_option").remove(),$("#citizen_option").prop("checked",!1)),Q()})):$("#filter_citizen_option")&&$("#filter_citizen_option").remove(),Q()}),$("#resident_option").click(function(){$("#resident_option").is(":checked")?($("#citizen_vs_resident_filters").append('<li id="filter_resident_option">Resident<i class="fas fa-window-close float-right"></i></li>'),$("#filter_resident_option i").click(function(){$("#filter_resident_option")&&($("#filter_resident_option").remove(),$("#resident_option").prop("checked",!1)),Q()})):$("#filter_resident_option")&&$("#filter_resident_option").remove(),Q()});var C=new google.visualization.ColumnChart(document.getElementById("citizensVsResidentsChart"));C.draw(w,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#marital-status-graph .spinner-block").hide(),$("#marital_status_filter").empty();var L=new google.visualization.DataTable;L.addColumn("string","Marital Status"),L.addColumn("number","Records"),L.addColumn({type:"string",role:"annotation"});var B=Object.keys(e.marital_statuses).map(function(a){return[i(e.marital_statuses[a].maritalStatus),e.marital_statuses[a].audience,X(e.marital_statuses[a].audience)]});for(var r in L.addRows(B),e.marital_statuses_distinct)I.includes(e.marital_statuses_distinct[r].maritalStatus)?$("#marital_status_filter").append('<input type="checkbox" name="m_'+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+'" id="m_'+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+'_option" value="'+e.marital_statuses_distinct[r].maritalStatus+'" class="css-checkbox" checked="checked"><label for="m_'+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+'_option" class="css-label">'+i(e.marital_statuses_distinct[r].maritalStatus)+"</label><br />"):$("#marital_status_filter").append('<input type="checkbox" name="m_'+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+'" id="m_'+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+'_option" value="'+e.marital_statuses_distinct[r].maritalStatus+'" class="css-checkbox"><label for="m_'+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+'_option" class="css-label">'+i(e.marital_statuses_distinct[r].maritalStatus)+"</label><br />"),$("#m_"+e.marital_statuses_distinct[r].maritalStatus.toLowerCase()+"_option").click(function(){if($("#m_"+$(this).val().toLowerCase()+"_option").is(":checked")){var e=this;$("#marital_status_filters").append('<li id="filter_m_'+$(this).val().toLowerCase()+'">'+i($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_m_"+$(this).val().toLowerCase()+" i").click(function(){$("#m_"+$(e).val().toLowerCase()+"_option").length&&($("#filter_m_"+$(e).val().toLowerCase()).remove(),$("#m_"+$(e).val().toLowerCase()+"_option").prop("checked",!1)),Q()})}else $("#filter_m_"+$(this).val().toLowerCase())&&$("#filter_m_"+$(this).val().toLowerCase()).remove();Q()});var z=new google.visualization.ColumnChart(document.getElementById("maritalStatusChart"));z.draw(L,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_()}}).done(function(e){te()}).fail(function(e){$("#age-graph .spinner-block").hide(),$("#age-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#age_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#gender-graph .spinner-block").hide(),$("#gender-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#gender_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#population-graph .spinner-block").hide(),$("#population-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#population_group_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#generation-graph .spinner-block").hide(),$("#generation-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#generation_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#c-vs-r-graph .spinner-block").hide(),$("#c-vs-r-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#citizen_vs_resident_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#marital-status-graph .spinner-block").hide(),$("#marital-status-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#marital_status_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)})}).fail(function(e){$("#contacts-number .spinner-block").hide(),$("#contacts-number .toast-body").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#province-graph .spinner-block").hide(),$("#province-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#province_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#map-graph .spinner-block").hide(),$("#map-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#area-graph .spinner-block").hide(),$("#area-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#area_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)})}var ae=function(e){return"Fourties"==e?"Forties":e};function te(){data={user_id:h,filter_type:g,api_token:u},$.ajax({url:"/api/meetpat-client/get-assets-data",type:"GET",data:data,success:function(e){$("#home-owner-graph .spinner-block").hide(),$("#home_owner_filter").empty();var r=new google.visualization.DataTable;r.addColumn("string","Home Owner Status"),r.addColumn("number","Records"),r.addColumn({type:"string",role:"annotation"});var o=Object.keys(e.home_owners).map(function(t){return[a(e.home_owners[t].homeOwnershipStatus),e.home_owners[t].audience,X(e.home_owners[t].audience)]});r.addRows(o);for(var i in e.home_owners_distinct)B.includes(e.home_owners_distinct[i].homeOwnershipStatus)?$("#home_owner_filter").append('<input type="checkbox" name="h_'+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase()+'" id="h_'+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase()+'_option" value="'+e.home_owners_distinct[i].homeOwnershipStatus+'" class="css-checkbox" checked="checked"><label for="h_'+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase()+'_option" class="css-label">'+a(e.home_owners_distinct[i].homeOwnershipStatus)+"</label><br />"):$("#home_owner_filter").append('<input type="checkbox" name="h_'+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase()+'" id="h_'+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase()+'_option" value="'+e.home_owners_distinct[i].homeOwnershipStatus+'" class="css-checkbox"><label for="h_'+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase()+'_option" class="css-label">'+a(e.home_owners_distinct[i].homeOwnershipStatus)+"</label><br />"),$("#h_"+e.home_owners_distinct[i].homeOwnershipStatus.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#h_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#home_owner_filters").append('<li id="filter_h_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+a($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_h_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#h_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_h_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#h_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_h_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_h_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});new google.visualization.ColumnChart(document.getElementById("homeOwnerChart")).draw(r,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#property-count-bucket-graph .spinner-block").hide(),$("#property_count_bucket_filter").empty();var n=new google.visualization.DataTable;n.addColumn("string","Property Count"),n.addColumn("number","Records"),n.addColumn({type:"string",role:"annotation"});var l=Object.keys(e.property_counts).map(function(a){return[e.property_counts[a].propertyCountBucket,e.property_counts[a].audience,X(e.property_counts[a].audience)]});n.addRows(l);for(var i in e.property_counts_distinct)O.includes(e.property_counts_distinct[i].propertyCountBucket)?$("#property_count_bucket_filter").append('<input type="checkbox" name="pc_'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'" id="pc_'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'_option" value="'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'" class="css-checkbox" checked="checked"><label for="pc_'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'_option" class="css-label">'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+"</label><br />"):$("#property_count_bucket_filter").append('<input type="checkbox" name="pc_'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'" id="pc_'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'_option" value="'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'" class="css-checkbox"><label for="pc_'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+'_option" class="css-label">'+e.property_counts_distinct[i].propertyCountBucket.toLowerCase()+"</label><br />"),$("#pc_"+e.property_counts_distinct[i].propertyCountBucket.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#pc_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#property_count_bucket_filters").append('<li id="filter_pc_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_pc_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#pc_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_pc_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#pc_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_pc_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_pc_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});new google.visualization.ColumnChart(document.getElementById("propertyCountBucketChart")).draw(n,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),_(),$("#vehicle-owner-graph .spinner-block").hide(),$("#vehicle_owner_filter").empty();var c=new google.visualization.DataTable;c.addColumn("string","Vehicle Owner Status"),c.addColumn("number","Records"),c.addColumn({type:"string",role:"annotation"});var s=Object.keys(e.vehicle_owners).map(function(a){return[t(e.vehicle_owners[a].vehicleOwnershipStatus),e.vehicle_owners[a].audience,X(e.vehicle_owners[a].audience)]});c.addRows(s);for(var i in e.vehicle_owners_distinct)N.includes(e.vehicle_owners_distinct[i].vehicleOwnershipStatus)?$("#vehicle_owner_filter").append('<input type="checkbox" name="vo_'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase()+'" id="vo_'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase()+'_option" value="'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus+'" class="css-checkbox" checked="checked"><label for="vo_'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase()+'_option" class="css-label">'+t(e.vehicle_owners_distinct[i].vehicleOwnershipStatus)+"</label><br />"):$("#vehicle_owner_filter").append('<input type="checkbox" name="vo_'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase()+'" id="vo_'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase()+'_option" value="'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus+'" class="css-checkbox"><label for="vo_'+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase()+'_option" class="css-label">'+t(e.vehicle_owners_distinct[i].vehicleOwnershipStatus)+"</label><br />"),$("#vo_"+e.vehicle_owners_distinct[i].vehicleOwnershipStatus.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#vo_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#vehicle_owner_filters").append('<li id="filter_vo_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+t($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_vo_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#vo_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_vo_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#vo_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_vo_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_vo_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});new google.visualization.ColumnChart(document.getElementById("vehicleOwnerChart")).draw(c,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_()}}).done(function(e){re()}).fail(function(e){$("#home-owner-graph .spinner-block").hide(),$("#home-owner-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#home_owner_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#property-count-bucket-graph .spinner-block").hide(),$("#property-count-bucket-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#property_count_bucket_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#primary-property-type-graph .spinner-block").hide(),$("#primary-property-type-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#primary_property_type_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#vehicle-owner-graph .spinner-block").hide(),$("#vehicle-owner-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#vehicle_owner_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)})}function re(){data={user_id:h,filter_type:g,api_token:u},$.ajax({url:"/api/meetpat-client/get-financial-data",type:"GET",data:data,success:function(t){$("#risk-category-graph .spinner-block").hide(),$("#risk_category_filter").empty();var o=new google.visualization.DataTable;o.addColumn("string","Age"),o.addColumn("number","Records"),o.addColumn({type:"string",role:"annotation"});var i=Object.keys(t.risk_categories).map(function(a){return[e(t.risk_categories[a].riskCategory.toLowerCase().replace("_"," ")),t.risk_categories[a].audience,X(t.risk_categories[a].audience)]});o.addRows(i);for(var n in t.risk_category_distinct)z.includes(t.risk_category_distinct[n].riskCategory)?$("#risk_category_filter").append('<input type="checkbox" name="r_'+t.risk_category_distinct[n].riskCategory+'" id="r_'+t.risk_category_distinct[n].riskCategory.toLowerCase()+'_option" value="'+t.risk_category_distinct[n].riskCategory+'" class="css-checkbox" checked="checked"><label for="r_'+t.risk_category_distinct[n].riskCategory.toLowerCase()+'_option" class="css-label">'+e(t.risk_category_distinct[n].riskCategory.toLowerCase().replace("_"," "))+"</label><br />"):$("#risk_category_filter").append('<input type="checkbox" name="r_'+t.risk_category_distinct[n].riskCategory+'" id="r_'+t.risk_category_distinct[n].riskCategory.toLowerCase()+'_option" value="'+t.risk_category_distinct[n].riskCategory+'" class="css-checkbox"><label for="r_'+t.risk_category_distinct[n].riskCategory.toLowerCase()+'_option" class="css-label">'+e(t.risk_category_distinct[n].riskCategory.toLowerCase().replace("_"," "))+"</label><br />"),$("#r_"+t.risk_category_distinct[n].riskCategory.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#r_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var a=this;$("#risk_category_filters").append('<li id="filter_r_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+e($(this).val().toLowerCase().replace(/[_]/g," "))+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_r_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#r_"+$(a).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_r_"+$(a).val().toLowerCase().replace(/ /g,"_")).remove(),$("#r_"+$(a).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_r_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_r_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});new google.visualization.BarChart(document.getElementById("riskCategoryChart")).draw(o,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#lsm-group-graph .spinner-block").hide(),$("#lsm_group_filter").empty();var l=new google.visualization.DataTable;l.addColumn("string","LSM Group"),l.addColumn("number","Records"),l.addColumn({type:"string",role:"annotation"});var c=Object.keys(t.lsm_groups).map(function(e){return[t.lsm_groups[e].lsmGroup,t.lsm_groups[e].audience,X(t.lsm_groups[e].audience)]});l.addRows(c);for(var n in t.lsm_groups_distinct)R.includes(t.lsm_groups_distinct[n].lsmGroup)?$("#lsm_group_filter").append('<input type="checkbox" name="lsm_'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+'" id="lsm_'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+'_option" value="'+t.lsm_groups_distinct[n].lsmGroup+'" class="css-checkbox" checked="checked"><label for="lsm_'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+'_option" class="css-label">'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+"</label><br />"):$("#lsm_group_filter").append('<input type="checkbox" name="lsm_'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+'" id="lsm_'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+'_option" value="'+t.lsm_groups_distinct[n].lsmGroup+'" class="css-checkbox"><label for="lsm_'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+'_option" class="css-label">'+t.lsm_groups_distinct[n].lsmGroup.toLowerCase()+"</label><br />"),$("#lsm_"+t.lsm_groups_distinct[n].lsmGroup.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#lsm_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#lsm_group_filters").append('<li id="filter_lsm_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_lsm_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#lsm_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_lsm_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#lsm_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_lsm_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_lsm_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});new google.visualization.BarChart(document.getElementById("lsmGroupChart")).draw(l,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#income-graph .spinner-block").hide(),$("#household_income_filter").empty();var s=new google.visualization.DataTable;s.addColumn("string","Income"),s.addColumn("number","Records"),s.addColumn({type:"string",role:"annotation"});var p=Object.keys(t.household_incomes).map(function(e){return[r(t.household_incomes[e].incomeBucket),t.household_incomes[e].audience,X(t.household_incomes[e].audience)]});s.addRows(p);for(var n in t.household_incomes_distinct)T.includes(t.household_incomes_distinct[n].incomeBucket)?$("#household_income_filter").append('<input type="checkbox" name="hi_'+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'" id="hi_'+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" value="'+t.household_incomes_distinct[n].incomeBucket+'" class="css-checkbox" checked="checked"><label for="hi_'+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" class="css-label">'+r(t.household_incomes_distinct[n].incomeBucket)+"</label><br />"):$("#household_income_filter").append('<input type="checkbox" name="hi_'+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'" id="hi_'+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" value="'+t.household_incomes_distinct[n].incomeBucket+'" class="css-checkbox"><label for="hi_'+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" class="css-label">'+r(t.household_incomes_distinct[n].incomeBucket)+"</label><br />"),$("#hi_"+t.household_incomes_distinct[n].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").click(function(){if($("#hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").is(":checked")){var e=this;$("#household_income_filters").append('<li id="filter_hi_'+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+" i").click(function(){$("#hi_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").length&&($("#filter_hi_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")).remove(),$("#hi_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").prop("checked",!1)),Q()})}else $("#filter_hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus"))&&$("#filter_hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")).remove();Q()});new google.visualization.BarChart(document.getElementById("householdIncomeChart")).draw(s,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$("#directors-graph .spinner-block").hide(),$("#directors_filter").empty();var d=new google.visualization.DataTable;d.addColumn("string","Director of Business"),d.addColumn("number","Records"),d.addColumn({type:"string",role:"annotation"});var h=Object.keys(t.company_directors).map(function(e){return[a(t.company_directors[e].directorshipStatus),t.company_directors[e].audience,X(t.company_directors[e].audience)]});d.addRows(h);for(var n in t.company_directors_distinct)E.includes(t.company_directors_distinct[n].directorshipStatus)?$("#directors_filter").append('<input type="checkbox" name="d_'+t.company_directors_distinct[n].directorshipStatus+'" id="d_'+t.company_directors_distinct[n].directorshipStatus.toLowerCase()+'_option" value="'+t.company_directors_distinct[n].directorshipStatus+'" class="css-checkbox" checked="checked"><label for="d_'+t.company_directors_distinct[n].directorshipStatus.toLowerCase()+'_option" class="css-label">'+a(t.company_directors_distinct[n].directorshipStatus)+"</label><br />"):$("#directors_filter").append('<input type="checkbox" name="d_'+t.company_directors_distinct[n].directorshipStatus+'" id="d_'+t.company_directors_distinct[n].directorshipStatus.toLowerCase()+'_option" value="'+t.company_directors_distinct[n].directorshipStatus+'" class="css-checkbox"><label for="d_'+t.company_directors_distinct[n].directorshipStatus.toLowerCase()+'_option" class="css-label">'+a(t.company_directors_distinct[n].directorshipStatus)+"</label><br />"),$("#d_"+t.company_directors_distinct[n].directorshipStatus.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#d_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#directors_filters").append('<li id="filter_d_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+a($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_d_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#d_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_d_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#d_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),Q()})}else $("#filter_d_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_d_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();Q()});new google.visualization.ColumnChart(document.getElementById("directorOfBusinessChart")).draw(d,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),_(),$(".apply-filter-button").prop("disabled",!1),$(".apply-filter-button").html("apply"),$("#sidebarSubmitBtn").html('<i class="fas fa-sync-alt"></i>&nbsp;Apply Filters'),$("#sidebarSubmitBtn").prop("disabled",!1),$("#resetFilterToastBtn").prop("disabled",!1),$("#audienceSubmitBtn").prop("disabled",!1),$("#resetFilterToastBtn").html('<i class="fas fa-undo-alt"></i>&nbsp;Reset Filters'),$("#downloadSubmitBtn").prop("disabled",!1),$("#saveAudienceBtn").prop("disabled",!1),$("#savedAudiencesBtn").prop("disabled",!1)}}).done(function(e){oe()}).fail(function(e){$("#risk-category-graph .spinner-block").hide(),$("#risk-category-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#risk_category_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#lsm-group-graph .spinner-block").hide(),$("#lsm-group-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#lsm_group_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#income-graph .spinner-block").hide(),$("#income-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#household_income_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#directors-graph .spinner-block").hide(),$("#directors-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#directors_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)})}function oe(){data={user_id:h,filter_type:g,api_token:u},$.ajax({url:"/api/meetpat-client/get-custom-metrics-data",type:"GET",data:data,success:function(e){e.branches.length||e.campaigns.length||($("#metrics-heading").hide(),$("#metrics-graphs").hide()),e.branches.length||$("#branch-graph").hide(),$("#branch-graph .spinner-block").hide(),$("#branch_filter").empty(),$("#branch_filter").append('<div id="branch-lunr-search" style="display: none;"><div class="input-group mb-2"><div class="input-group-prepend"><div class="input-group-text"><i class="fas fa-search"></i></div></div><input type="text" class="form-control" id="branchSearchInput" placeholder="search for branches"></div><ul id="branch-lunr-results" class="list-unstyled"></ul></div>');var a=new google.visualization.DataTable;a.addColumn("string","Branch"),a.addColumn("number","Records"),a.addColumn({type:"string",role:"annotation"});var t=Object.keys(e.branches).map(function(a){return[e.branches[a].branch,e.branches[a].audience,X(e.branches[a].audience)]}),r=Object.keys(e.branches_distinct).map(function(a){return{name:e.branches_distinct[a].branch,count:X(e.branches_distinct[a].audience)}}),o=t.slice(0,20);if(a.addRows(t),o.length>6)var i={height:40*t.length,width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};else i={width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};new google.visualization.BarChart(document.getElementById("branchChart")).draw(a,i),_();var n=r,l=lunr(function(){this.ref("name"),this.field("name"),this.k1(1.5),this.b(.25),n.forEach(function(e){this.add(e)},this)});$("#branch-lunr-search").show(),$("#branch-filter-form .text-center").remove(),o.forEach(function(e){$("#branch_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#branch-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+r.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#branch_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-branch-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+'" checked="checked"><small> '+r.filter(a=>{if(a.name===e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_filters").append('<li id="filter_branch_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#branch_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#branch-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+r.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#branch_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-branch-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#branch_filters").append('<li id="filter_branch_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#branch_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}),document.getElementById("branchSearchInput").addEventListener("keyup",function(){l.search(this.value+"*").length&&""!=this.value?($("#branch-lunr-results").empty(),l.search(this.value+"*").forEach(function(e){e.score&&($("#branch_hidden_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#branch-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox" checked="checked"><label for="branch_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+r.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#branch_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-branch-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#branch_filters").append('<li id="filter_branch_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#branch_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#branch-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox"><label for="branch_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+r.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#branch_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-branch-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#branch_filters").append('<li id="filter_branch_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#branch_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})))})):($("#branch-lunr-results").empty(),o.forEach(function(e){$("#branch_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#branch-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+r.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#branch_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-branch-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#branch_filters").append('<li id="filter_branch_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#branch_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#branch-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="branch_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+r.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#branch_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#branch_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-branch-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="branch_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#branch_filters").append('<li id="filter_branch_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#branch_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#branch_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_branch_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#branch_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}))}),e.campaigns.length||$("#campaign-graph").hide(),$("#campaign-graph .spinner-block").hide(),$("#campaign_filter").empty(),$("#campaign_filter").append('<div id="campaign-lunr-search" style="display: none;"><div class="input-group mb-2"><div class="input-group-prepend"><div class="input-group-text"><i class="fas fa-search"></i></div></div><input type="text" class="form-control" id="campaignSearchInput" placeholder="search for campaigns"></div><ul id="campaign-lunr-results" class="list-unstyled"></ul></div>');var c=new google.visualization.DataTable;c.addColumn("string","Campaign"),c.addColumn("number","Records"),c.addColumn({type:"string",role:"annotation"});var s=Object.keys(e.campaigns).map(function(a){return[e.campaigns[a].campaign,e.campaigns[a].audience,X(e.campaigns[a].audience)]}),p=Object.keys(e.campaigns_distinct).map(function(a){return{name:e.campaigns_distinct[a].campaign,count:X(e.campaigns_distinct[a].audience)}}),d=s.slice(0,20);if(c.addRows(s),d.length>6)var h={height:40*s.length,width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};else h={width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};new google.visualization.BarChart(document.getElementById("campaignChart")).draw(c,h),_();var u=p,g=lunr(function(){this.ref("name"),this.field("name"),this.k1(1.5),this.b(.25),u.forEach(function(e){this.add(e)},this)});$("#campaign-lunr-search").show(),$("#campaign-filter-form .text-center").remove(),d.forEach(function(e){$("#campaign_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#campaign-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+p.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#campaign_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-campaign-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+'" checked="checked"><small> '+p.filter(a=>{if(a.name===e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_filters").append('<li id="filter_campaign_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#campaign_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#campaign-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+p.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#campaign_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-campaign-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#campaign_filters").append('<li id="filter_campaign_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#campaign_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}),document.getElementById("campaignSearchInput").addEventListener("keyup",function(){g.search(this.value+"*").length&&""!=this.value?($("#campaign-lunr-results").empty(),g.search(this.value+"*").forEach(function(e){e.score&&($("#campaign_hidden_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#campaign-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox" checked="checked"><label for="campaign_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+p.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#campaign_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-campaign-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#campaign_filters").append('<li id="filter_campaign_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#campaign_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#campaign-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox"><label for="campaign_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+p.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#campaign_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-campaign-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#campaign_filters").append('<li id="filter_campaign_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#campaign_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})))})):($("#campaign-lunr-results").empty(),d.forEach(function(e){$("#campaign_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#campaign-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+p.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#campaign_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-campaign-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#campaign_filters").append('<li id="filter_campaign_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#campaign_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#campaign-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="campaign_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+p.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#campaign_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#campaign_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-campaign-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="campaign_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#campaign_filters").append('<li id="filter_campaign_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#campaign_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#campaign_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_campaign_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#campaign_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}))}),e.sources.length||$("#source-graph").hide(),$("#source-graph .spinner-block").hide(),$("#source_filter").empty(),$("#source_filter").append('<div id="source-lunr-search" style="display: none;"><div class="input-group mb-2"><div class="input-group-prepend"><div class="input-group-text"><i class="fas fa-search"></i></div></div><input type="text" class="form-control" id="sourceSearchInput" placeholder="search for sources"></div><ul id="source-lunr-results" class="list-unstyled"></ul></div>');var f=new google.visualization.DataTable;f.addColumn("string","source"),f.addColumn("number","Records"),f.addColumn({type:"string",role:"annotation"});var m=Object.keys(e.sources).map(function(a){return[e.sources[a].source,e.sources[a].audience,X(e.sources[a].audience)]}),v=Object.keys(e.sources_distinct).map(function(a){return{name:e.sources_distinct[a].source,count:X(e.sources_distinct[a].audience)}}),w=m.slice(0,20);if(f.addRows(m),w.length>6)var b={height:40*m.length,width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};else b={width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};new google.visualization.BarChart(document.getElementById("sourceChart")).draw(f,b),_();var C=v,L=lunr(function(){this.ref("name"),this.field("name"),this.k1(1.5),this.b(.25),C.forEach(function(e){this.add(e)},this)});$("#source-lunr-search").show(),$("#source-filter-form .text-center").remove(),w.forEach(function(e){$("#source_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#source-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+v.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#source_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-source-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+'" checked="checked"><small> '+v.filter(a=>{if(a.name===e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_filters").append('<li id="filter_source_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#source_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#source-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+v.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#source_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-source-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#source_filters").append('<li id="filter_source_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#source_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}),document.getElementById("sourceSearchInput").addEventListener("keyup",function(){L.search(this.value+"*").length&&""!=this.value?($("#source-lunr-results").empty(),L.search(this.value+"*").forEach(function(e){e.score&&($("#source_hidden_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#source-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox" checked="checked"><label for="source_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+v.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#source_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-source-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#source_filters").append('<li id="filter_source_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#source_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#source-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox"><label for="source_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+v.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#source_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-source-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#source_filters").append('<li id="filter_source_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#source_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})))})):($("#source-lunr-results").empty(),w.forEach(function(e){$("#source_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#source-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+v.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#source_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-source-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#source_filters").append('<li id="filter_source_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#source_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#source-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="source_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+v.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#source_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#source_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-source-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="source_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#source_filters").append('<li id="filter_source_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#source_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#source_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_source_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#source_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}))}),e.others.length||$("#other-graph").hide(),$("#other-graph .spinner-block").hide(),$("#other_filter").empty(),$("#other_filter").append('<div id="other-lunr-search" style="display: none;"><div class="input-group mb-2"><div class="input-group-prepend"><div class="input-group-text"><i class="fas fa-search"></i></div></div><input type="text" class="form-control" id="otherSearchInput" placeholder="search for others"></div><ul id="other-lunr-results" class="list-unstyled"></ul></div>');var k=new google.visualization.DataTable;k.addColumn("string","other"),k.addColumn("number","Records"),k.addColumn({type:"string",role:"annotation"});var y=Object.keys(e.others).map(function(a){return[e.others[a].other,e.others[a].audience,X(e.others[a].audience)]}),x=Object.keys(e.others_distinct).map(function(a){return{name:e.others_distinct[a].other,count:X(e.others_distinct[a].audience)}}),S=y.slice(0,20);if(k.addRows(y),S.length>6)var A={height:40*y.length,width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};else A={width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};new google.visualization.BarChart(document.getElementById("otherChart")).draw(k,A),_();var I=x,B=lunr(function(){this.ref("name"),this.field("name"),this.k1(1.5),this.b(.25),I.forEach(function(e){this.add(e)},this)});$("#other-lunr-search").show(),$("#other-filter-form .text-center").remove(),S.forEach(function(e){$("#other_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#other-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#other_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-other-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+'" checked="checked"><small> '+x.filter(a=>{if(a.name===e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_filters").append('<li id="filter_other_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#other_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#other-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#other_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-other-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#other_filters").append('<li id="filter_other_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#other_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1)),Q()})}else $("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}),document.getElementById("otherSearchInput").addEventListener("keyup",function(){B.search(this.value+"*").length&&""!=this.value?($("#other-lunr-results").empty(),B.search(this.value+"*").forEach(function(e){e.score&&($("#other_hidden_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#other-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox" checked="checked"><label for="other_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+x.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#other_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-other-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#other_filters").append('<li id="filter_other_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#other_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#other-lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox"><label for="other_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+x.filter(a=>{if(a.name===e.ref)return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#other_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-other-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#other_filters").append('<li id="filter_other_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#other_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})))})):($("#other-lunr-results").empty(),S.forEach(function(e){$("#other_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length?($("#other-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#other_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-other-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#other_filters").append('<li id="filter_other_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#other_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()})):($("#other-lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="other_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+x.filter(a=>{if(a.name===e[0])return a.count}).map(function(e){return e.count})[0]+"</small></label><br />"),$("#other_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").click(function(){if($("#other_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").is(":checked")){var a=this;$("#hidden-other-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'" id="other_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#other_filters").append('<li id="filter_other_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+" i").click(function(){$("#other_hidden_"+$(a).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").length&&($("#filter_other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove(),$("#other_"+$(a).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").prop("checked",!1))})}else $("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,""))&&($("#filter_other_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")).remove(),$("#other_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&@()%\/\|]/g,"")+"_option").remove());Q()}))}))})}}).done(function(){d()}).fail(function(e){console.log(e),$("#branches-graph .spinner-block").hide(),$("#branches-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#branch_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#campaigns-graph .spinner-block").hide(),$("#campaigns-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#campaign_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#sources-graph .spinner-block").hide(),$("#sources-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#source_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),$("#others-graph .spinner-block").hide(),$("#others-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#other_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>')})}var ie=function(){$("#province-graph .spinner-block").show(),$("#provincesChart").empty(),$("#province_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#municipality-graph .spinner-block").show(),$("#municipalityChart").empty(),$("#map-graph .spinner-block").show(),$("#chartdiv").empty(),$("#area-graph .spinner-block").show(),$("#areasChart").empty(),$("#area_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#age-graph .spinner-block").show(),$("#agesChart").empty(),$("#age_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#gender-graph .spinner-block").show(),$("#genderChart").empty(),$("#gender_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#population-graph .spinner-block").show(),$("#populationGroupChart").empty(),$("#population_group_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#generation-graph .spinner-block").show(),$("#generationChart").empty(),$("#generation_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#c-vs-r-graph .spinner-block").show(),$("#citizensVsResidentsChart").empty(),$("#citizen_vs_resident_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#marital-status-graph .spinner-block").show(),$("#maritalStatusChart").empty(),$("#marital_status_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#home-owner-graph .spinner-block").show(),$("#homeOwnerChart").empty(),$("#home_owner_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#risk-category-graph .spinner-block").show(),$("#riskCategoryChart").empty(),$("#risk_category_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#income-graph .spinner-block").show(),$("#householdIncomeChart").empty(),$("#household_income_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#directors-graph .spinner-block").show(),$("#directorOfBusinessChart").empty(),$("#directors_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#vehicle-owner-graph .spinner-block").show(),$("#vehicleOwnerChart").empty(),$("#vehicle_owner_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#lsm-group-graph .spinner-block").show(),$("#lsmGroupChart").empty(),$("#lsm_group_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#property-valuation-graph .spinner-block").show(),$("#propertyValuationChart").empty(),$("#property_valuation_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#property-count-bucket-graph .spinner-block").show(),$("#propertyCountBucketChart").empty(),$("#property_count_bucket_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#primary-property-type-graph .spinner-block").show(),$("#primaryPropertyTypeChart").empty(),$("#primary_property_type_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#branch-graph .spinner-block").show(),$("#branchChart").empty(),$("#branch_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#campaign-graph .spinner-block").show(),$("#campaignChart").empty(),$("#campaign_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#source-graph .spinner-block").show(),$("#sourceChart").empty(),$("#source_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#other-graph .spinner-block").show(),$("#otherChart").empty(),$("#other_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#records-main-toast .toast-body").html('<div class="d-flex justify-content-center"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#records-toast .toast-body").html('<div class="d-flex justify-content-center"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>')};$(".apply-filter-button, #sidebarSubmitBtn, #apply-toggle-button").click(function(){window.scrollTo(0,0),Q(),p=0,$("#progress_popup .progress-bar").width("0%"),$("#progress_popup").show(),$(".apply-filter-button").prop("disabled",!0),$("#sidebarSubmitBtn").prop("disabled",!0),$("#audienceSubmitBtn").prop("disabled",!0),$(".apply-filter-button").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;applying...'),$("#sidebarSubmitBtn").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Applying Filters...'),$("#resetFilterToastBtn").prop("disabled",!0),$(".apply-filter-button").prop("disabled",!0),$("#saveAudienceBtn").prop("disabled",!0),$("#savedAudiencesBtn").prop("disabled",!0),b=[],C=[],L=[],k=[],y=[],x=[],S=[],A=[],I=[],B=[],z=[],T=[],E=[],N=[],R=[],G=[],O=[],M=[],j=[],F=[],D=[],P=[],$("#province-filter-form input[type='checkbox']").each(function(){this.checked&&b.push($(this).val())}),$("#age-filter-form input[type='checkbox']").each(function(){this.checked&&k.push($(this).val())}),$("#gender-filter-form input[type='checkbox']").each(function(){this.checked&&y.push($(this).val())}),$("#population-group-filter-form input[type='checkbox']").each(function(){this.checked&&x.push($(this).val())}),$("#generation-filter-form input[type='checkbox']").each(function(){this.checked&&S.push($(this).val())}),$("#marital-status-filter-form input[type='checkbox']").each(function(){this.checked&&I.push($(this).val())}),$("#home-owner-filter-form input[type='checkbox']").each(function(){this.checked&&B.push($(this).val())}),$("#vehicle-owner-filter-form input[type='checkbox']").each(function(){this.checked&&N.push($(this).val())}),$("#property-valuation-filter-form input[type='checkbox']").each(function(){this.checked&&G.push($(this).val())}),$("#property-count-bucket-filter-form input[type='checkbox']").each(function(){this.checked&&O.push($(this).val())}),$("#primary-property-type-filter-form input[type='checkbox']").each(function(){this.checked&&M.push($(this).val())}),$("#lsm-group-filter-form input[type='checkbox']").each(function(){this.checked&&R.push($(this).val())}),$("#risk-categories-filter-form input[type='checkbox']").each(function(){this.checked&&z.push($(this).val())}),$("#household-income-filter-form input[type='checkbox']").each(function(){this.checked&&T.push($(this).val())}),$("#directors-filter-form input[type='checkbox']").each(function(){this.checked&&E.push($(this).val())}),$("#citizen-vs-resident-filter-form input[type='checkbox']").each(function(){this.checked&&A.push($(this).val())}),$("#municipality-filter-form input[type='checkbox']").each(function(){this.checked&&C.push($(this).val())}),$("#hidden-area-filter-form input[type='checkbox']").each(function(){this.checked&&(L.includes($(this).val())||L.push($(this).val()))}),$("#hidden-branch-filter-form input[type='checkbox']").each(function(){this.checked&&j.push($(this).val())}),$("#hidden-campaign-filter-form input[type='checkbox']").each(function(){this.checked&&F.push($(this).val())}),$("#hidden-source-filter-form input[type='checkbox']").each(function(){this.checked&&D.push($(this).val())}),$("#hidden-other-filter-form input[type='checkbox']").each(function(){this.checked&&P.push($(this).val())}),$("#provinceContactsId").val(b),$("#areaContactsId").val(L),$("#municipalityContactsID").val(C),$("#AgeContactsId").val(k),$("#GenderContactsId").val(y),$("#populationContactsId").val(x),$("#generationContactsId").val(S),$("#citizenshipIndicatorContactsId").val(A),$("#maritalStatusContactsId").val(I),$("#homeOwnerContactsId").val(B),$("#riskCategoryContactsId").val(z),$("#houseHoldIncomeContactsId").val(T),$("#directorsContactsId").val(E),$("#vehicleOwnerContactsId").val(N),$("#lsmGroupContactsId").val(R),$("#propertyValuationContactsId").val(G),$("#propertyCountBucketContactsId").val(O),$("#primaryPropertyTypeContactsId").val(M),$("#branchContactsId").val(j),$("#campaignContactsId").val(F),$("#sourceContactsId").val(D),$("#otherContactsId").val(P),ie(),$.post({type:"POST",url:"/api/meetpat-client/submit-filter",data:{user_id:h,provinces:b.join(","),age_groups:k.join(","),genders:y.join(","),population_groups:x.join(","),generations:S.join(","),marital_statuses:I.join(","),home_ownership_statuses:B.join(","),risk_categories:z.join(","),income_buckets:T.join(","),company_directorship_status:E.join(","),citizens_vs_residents:A.join(","),municipalities:C.join(","),areas:L.join(","),vehicle_ownership_statuses:N.join(","),property_valuation_buckets:G.join(","),lsm_groups:R.join(","),property_count_buckets:O.join(","),primary_property_types:M.join(","),custom_variable_1:j.join(","),custom_variable_2:F.join(","),custom_variable_3:D.join(","),custom_variable_4:P.join(","),api_token:u,filter_type:"filter",status:"processing"},success:function(e){!function a(t){$.get("/api/meetpat-client/filter-job-status",{job_id:e.id,api_token:u},function(e){}).fail(function(e){console.log(e)}).done(function(e){if("complete"==e)return g="filter",t(e);setTimeout(function(){a(t)},3e3)})}((e,a)=>{ee(),a&&console.error(a)})},error:function(e){console.log(e)}})}),$("#resetFilterToastBtn, #reset-toggle-button").click(function(){$("#sidebar-toggle-button").hasClass("sidebar-button-in")||($("#sidebar-toggle-button").html('<i class="fas fa-cog"></i>'),$("#right-options-sidebar").addClass("sidebar-in"),$("#sidebar-toggle-button").addClass("sidebar-button-in")),window.scrollTo(0,0),p=0,$("#progress_popup .progress-bar").width("0%"),$("#progress_popup").show(),Q(),$("#resetFilterToastBtn").prop("disabled",!0),$("#resetFilterToastBtn").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Resetting...'),$(".apply-filter-button, .apply-changes-button").prop("disabled",!0),$(".sidebar-filters ul li").remove(),$(".sidebar-filters ul").hide(),$("#no_filters").show(),b=[],C=[],L=[],k=[],y=[],x=[],S=[],A=[],I=[],B=[],z=[],T=[],E=[],N=[],R=[],G=[],O=[],M=[],j=[],F=[],D=[],P=[],K=0,W=0,V=0,q=0,Y=0,Z=0,H=0,U=0,J=0,$("#provinceContactsId").val(b),$("#areaContactsId").val(L),$("#municipalityContactsID").val(C),$("#AgeContactsId").val(k),$("#GenderContactsId").val(y),$("#populationContactsId").val(x),$("#generationContactsId").val(S),$("#citizenshipIndicatorContactsId").val(A),$("#maritalStatusContactsId").val(I),$("#homeOwnerContactsId").val(B),$("#riskCategoryContactsId").val(z),$("#houseHoldIncomeContactsId").val(T),$("#directorsContactsId").val(E),$("#vehicleOwnerContactsId").val(N),$("#lsmGroupContactsId").val(R),$("#propertyValuationContactsId").val(G),$("#propertyCountBucketContactsId").val(O),$("#primaryPropertyTypeContactsId").val(M),$("#hidden-area-filter-form").empty(),$("#hidden-branch-filter-form").empty(),$("#hidden-campaign-filter-form").empty(),$("#hidden-source-filter-form").empty(),$("#hidden-other-filter-form").empty(),$("input:checkbox").each(function(e){$(e).is(":checked")&&$(e).prop("checked",!1)}),ie(),g="all_records",ee()});var ne,le,ce=function(){$("#btn_prev").off(),$("#btn_next").off(),$("#userSavedFiles").html('<div class="d-flex justify-content-center w-100"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>'),$.get("/api/meetpat-client/get-saved-audiences",{user_id:h,api_token:u},function(e){$("#userSavedFiles .d-flex").remove(),w(e)>=f?v(f,e):(v(f-1,e),f-=1)}).fail(function(e){console.log(e)}).done(function(e){$("#paginationContainer").attr("data-current-page",f),$("#paginationContainer").attr("data-number-of-pages",w(e)),e.length?($("#btn_prev").on("click",function(a){a.preventDefault(),f>1&&v(--f,e)}),$("#btn_next").on("click",function(a){a.preventDefault(),f<w(e)&&v(++f,e)})):$("#userSavedFiles").append('<div class="col-12"><div class="alert alert-info">You have not saved any audiences yet.</div></div>')})};ne=$("#attributes_placeholder"),le=$("#records_placeholder"),$.get("/api/meetpat-client/get-records/count",{user_id:h},function(e){}).fail(function(e){$("#contacts-number .spinner-block").hide(),$("#contacts-number .toast-body").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#progress_popup").show(),ne.html(X(17*e)),le.html(X(e)),$("#contacts-number .spinner-block").hide()}),ce(),$("#records-main-toast").toast("show"),$("#records-toast").toast("show"),$(".dropdown-menu, .dropdown-toggle").on("click",function(e){$(this).hasClass("dropdown-menu-form")&&e.stopPropagation()}),$("#SavedAudiencesModal").on("show.bs.modal",function(){$("#SaveAudienceModal").modal("hide"),s()}),$("#SaveAudienceModal").on("show.bs.modal",function(){$("#SavedAudiencesModal").modal("hide"),$("#nameFile").val().length>1&&$("#nameFile").val().match(/^([A-z\_0-9])\w+$/g)?$("#downloadSubmitBtn").prop("disabled",!1):$("#downloadSubmitBtn").prop("disabled",!0),s()}),$("#SavedAudiencesModal").on("hide.bs.modal",function(){s()}),$("#SaveAudienceModal").on("hide.bs.modal",function(){s()}),ee(),$("#sidebar-toggle-button").click(function(){s()}),$("#nameFile").on("input",function(){$("#nameFile").val().length>1&&$("#nameFile").val().match(/^([A-z\_0-9])\w+$/g)?($("#nameFile").removeClass("is-invalid"),$("#nameFile").addClass("is-valid"),$("#downloadSubmitBtn").prop("disabled",!1)):($("#nameFile").removeClass("is-valid"),$("#nameFile").addClass("is-invalid"),$("#downloadSubmitBtn").prop("disabled",!0))}),$("#downloadSubmitBtn").click(function(){if(function(e){inputs_array=[];var a=$("#savedAudiencesForm").serializeArray();return $(a).each(function(e,a){inputs_array.push(a.value)}),inputs_array.includes(e)}($("#nameFile").val()))$("#SaveAudienceModal .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> You can\'t have a file with the same name.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>');else{$("#SaveAudienceModal .alerts").empty();var e={};$("#filtersForm").serializeArray().map(function(a){return e[a.name]=a.value}),e.file_name=$("#nameFile").val(),$("#SaveAudienceModal button").prop("disabled",1),$("#downloadSubmitBtn").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Saving...'),$.post("/api/meetpat-client/filtered-audience/save",e,function(e){}).fail(function(e){$("#downloadSubmitBtn").prop("disabled",!1),$("#downloadSubmitBtn").html('<i class="far fa-save"></i>&nbsp;Save Contacts'),$("#savedAudiencesForm .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> There was an error saving file names. Please contact MeetPAT for support.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#SavedAudiencesModal").modal("show"),console.log(e)}).done(function(e){var a=setInterval(function(){$.post("/api/meetpat-client/saved-file-job-status",{id:e.job.id},function(e){}).fail(function(e){console.log(e)}).done(function(e){"complete"==e.job.status&&(clearInterval(a),$("#downloadSubmitBtn").prop("disabled",!1),$("#downloadSubmitBtn").html('<i class="far fa-save"></i>&nbsp;Save Contacts'),$("#SavedAudiencesModal").modal("show"),$("#SaveAudienceModal button").prop("disabled",0),$("#SaveAudienceModal").modal({backdrop:!0,keyboard:!0}),ce())})},3e3)})}}),$("#saveFileNameEdits").click(function(){if(0==function(){inputs_array=[];var e=$("#savedAudiencesForm").serializeArray();return $(e).each(function(e,a){inputs_array.push(a.value)}),function(e){var a={},t=[];for(var r in e.forEach(function(e){a[e]||(a[e]=0),a[e]+=1}),a)a[r]>=2&&t.push(r);return t}(inputs_array)}().length){$("#savedAudiencesForm .alerts").empty(),$("#SavedAudiencesModal button").prop("disabled",1);var e={},a=$(this),t=$("#btn_next_item").hasClass("disabled"),r=$("#btn_prev_item").hasClass("disabled");$("#savedAudiencesForm").serializeArray().map(function(a){return e[a.name]=a.value}),e.user_id=h,a.prop("disabled",!0),a.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Saving...'),t||$("#btn_next_item").addClass("disabled"),r||$("#btn_prev_item").addClass("disabled"),$(".delete_file_btn").prop("disabled",!0),$.post("/api/meetpat-client/save-filename-edits",e,function(e){$("#savedAudiencesForm .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> There was an error saving file names. Please contact MeetPAT for support.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}).fail(function(e){a.prop("disabled",!1),a.html("Save Changes"),t||$("#btn_next_item").removeClass("disabled"),r||$("#btn_prev_item").removeClass("disabled"),$(".delete_file_btn").prop("disabled",!1),a.prop("disabled",!1),a.html("Save Changes"),$("#SavedAudiencesModal button").prop("disabled",0),console.log(e)}).done(function(e){$(".delete_file_btn").prop("disabled",!1),t||$("#btn_next_item").removeClass("disabled"),r||$("#btn_prev_item").removeClass("disabled"),ce(),$("#SavedAudiencesModal button").prop("disabled",0),a.prop("disabled",!1),a.html("Save Changes"),$("#savedAudiencesForm .alerts").html('<div class="alert alert-success alert-dismissible fade show" role="alert"><strong>Success!</strong> File names updated successfully.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')})}else $("#savedAudiencesForm .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> You can\'t have files with the same name.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}),$(window).width()<=475?(initial_scroll=160,window.addEventListener("scroll",function(){window.scrollY<120&&window.scrollY>0?$("#progress_popup").css({"padding-top":initial_scroll-window.scrollY+"px"}):window.scrollY>120?$("#progress_popup").css({"padding-top":"25px"}):(initial_scroll=160,$("#progress_popup").css({"padding-top":"160px"}))},!1)):(initial_scroll=145,window.addEventListener("scroll",function(){window.scrollY<120&&window.scrollY>0?$("#progress_popup").css({"padding-top":initial_scroll-window.scrollY+"px"}):window.scrollY>120?$("#progress_popup").css({"padding-top":"25px"}):(initial_scroll=145,$("#progress_popup").css({"padding-top":"145px"}))},!1))});