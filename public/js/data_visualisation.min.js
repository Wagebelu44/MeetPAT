google.charts.load("current",{packages:["corechart","geochart","bar"],mapsApiKey:"AIzaSyBMae5h5YHUJ1BdNHshwj_SmJzPe5mglwI"});var keyChanger=function(e){return"True"==e||"true"==e?"Yes":"False"==e||"false"==e?"No":e},keyChangerPrValBucket=function(e){switch(e){case"R0 - R1 000 000":return"R0K - R1M";case"R1 000 000 - R2 000 000":return"R1M - R2M";case"R2 000 000 - R4 000 000":return"R2M - R4M";case"R4 000 000 - R6 000 000":return"R4M - R6M";case"R7 000 000+":return"R7M +";default:return"Unknown"}},keyChangerHsIncBucket=function(e){switch(e){case"R0 - R2 500":return"R0K - R2.5K";case"R2 500 - R5 000":return"R2.5K - R5K";case"R5 000 - R10 000":return"R5K - R10K";case"R10 000 - R20 000":return"R10K - R20K";case"R20 000 - R30 000":return"R20K - R30K";case"R30 000 - R40 000":return"R30K - R40K";case"R40 000 +":return"R40K +";default:return"Unknown"}},keyChangerGender=function(e){switch(e){case"M":return"Male";case"F":return"Female";default:return"Unknown"}},keyChangerMaritalStatus=function(e){return"True"==e||"true"==e?"Married":"False"==e||"false"==e?"Not Married":e},toggle_side_bar=function(){$("#sidebar-toggle-button").hasClass("sidebar-button-in")?$("#sidebar-toggle-button").html('<i class="fas fa-arrow-right"></i>'):$("#sidebar-toggle-button").html('<i class="fas fa-cog"></i>'),$("#right-options-sidebar").toggleClass("sidebar-in"),$("#sidebar-toggle-button").toggleClass("sidebar-button-in")},data_fetched=0,update_progress=function(){18!=data_fetched&&data_fetched++,$("#progress_popup .progress-bar").width(Math.round(data_fetched/18*100)+"%"),$("#progress_popup .progress-bar").attr("aria-valuenow",Math.round(data_fetched/18*100))},hide_progress=function(){setTimeout(function(){$("#progress_popup").hide()},1e3)},user_id_number=$("#user_id").val(),current_page=1,records_per_page=5;function changePage(e,t){var a=document.getElementById("userSavedFiles"),r=document.getElementById("page_span");e<1&&(e=1),e>numPages(t)&&(e=numPages(t)),a.innerHTML="";for(var i=(e-1)*records_per_page;i<e*records_per_page&&i<t.length;i++)audience_file=t[i],$("#userSavedFiles").append(`<div class="col-9 mb-1" id="file_name_${audience_file.file_unique_name}"><input id="input_${audience_file.file_unique_name}" class="form-control" name="${audience_file.file_unique_name}" value="${audience_file.file_name}" readonly></div><div class="col-3 mb-1" id="file_actions_${audience_file.file_unique_name}"><div class="btn-group float-right" role="group" aria-label="Basic example"><a type="button" id="download_${audience_file.file_unique_name}" href="${audience_file.link}" class="btn btn-light" download><i class="fas fa-file-download"></i></a><button type="button" id="edit_${audience_file.file_unique_name}" onclick="edit_file('${audience_file.file_unique_name}')" class="btn btn-light"><i class="far fa-edit"></i></button><button type="button" id="delete_${audience_file.file_unique_name}" onclick="delete_file('${audience_file.file_unique_name}','${audience_file.file_name}');" class="btn btn-danger delete_file_btn"><i class="fas fa-trash-alt"></i></button></div></div>`);t.forEach(function(e){0==$("#input_"+e.file_unique_name).length&&$("#userSavedFiles").append(`<div class="col-9 mb-1 d-none" id="file_name_${e.file_unique_name}"><input id="input_${e.file_unique_name}" class="form-control" name="${e.file_unique_name}" value="${e.file_name}" readonly></div><div class="col-3 mb-1 d-none" id="file_actions_${e.file_unique_name}"><div class="btn-group float-right" role="group" aria-label="Basic example"><a type="button" id="download_${e.file_unique_name}" href="${e.link}" class="btn btn-light" download><i class="fas fa-file-download"></i></a><button type="button" id="edit_${e.file_unique_name}" onclick="edit_file('${e.file_unique_name}')" class="btn btn-light"><i class="far fa-edit"></i></button><button type="button" id="delete_${e.file_unique_name}" onclick="delete_file('${e.file_unique_name}','${e.file_name}');" class="btn btn-danger delete_file_btn"><i class="fas fa-trash-alt"></i></button></div></div>`)}),1==e?document.getElementById("btn_prev_item").classList.add("disabled"):document.getElementById("btn_prev_item").classList.remove("disabled"),e==numPages(t)?document.getElementById("btn_next_item").classList.add("disabled"):document.getElementById("btn_next_item").classList.remove("disabled"),r.innerHTML=e+" of "+numPages(t)}function numPages(e){return Math.ceil(e.length/records_per_page)}var edit_file=function(e){$("#input_"+e).attr("readonly")?$("#input_"+e).removeAttr("readonly"):$("#input_"+e).attr("readonly",!0)};function find_duplicate_in_array(e){var t={},a=[];for(var r in e.forEach(function(e){t[e]||(t[e]=0),t[e]+=1}),t)t[r]>=2&&a.push(r);return a}var file_name_exists=function(e){inputs_array=[];var t=$("#savedAudiencesForm").serializeArray();return $(t).each(function(e,t){inputs_array.push(t.value)}),inputs_array.includes(e)},no_same_file_names=function(){inputs_array=[];var e=$("#savedAudiencesForm").serializeArray();return $(e).each(function(e,t){inputs_array.push(t.value)}),find_duplicate_in_array(inputs_array)},delete_file=function(e,t){var a=confirm("Are you sure that you want to delete: "+t+"?");$(".delete_file_btn").prop("disabled",!0),$(".page-item").addClass("disabled"),1==a&&($("#delete_"+e).html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span><span class="sr-only">Loading...</span>'),$.post("/api/meetpat-client/delete-saved-audience-file",{user_id:user_id_number,file_unique_name:e},function(t){$("#file_name_"+e).remove(),$("#file_actions_"+e).remove()}).fail(function(t){$("#delete_"+e).html('<i class="fas fa-trash-alt"></i>'),$(".delete_file_btn").prop("disabled",!1),$(".page-item").removeClass("disabled"),console.log(t)}).done(function(){$("#delete_"+e).html('<i class="fas fa-trash-alt"></i>'),$(".delete_file_btn").prop("disabled",!1),$(".page-item").removeClass("disabled"),get_saved_audiences()}))},target_provinces=[],target_municipalities=[],target_areas=[],target_ages=[],target_genders=[],target_population_groups=[],target_generations=[],target_citizen_vs_residents=[],target_marital_statuses=[],target_home_owners=[],target_risk_categories=[],target_incomes=[],target_directors=[],target_vehicle_owners=[],target_lsm_groups=[],target_property_valuations=[],target_property_count_buckets=[],checkForFilters=function(){var e=document.getElementById("province_filters"),t=document.getElementById("municipality_filters"),a=document.getElementById("area_filters"),r=document.getElementById("age_filters"),i=document.getElementById("gender_filters"),o=document.getElementById("population_group_filters"),n=document.getElementById("generation_filters"),s=document.getElementById("citizen_vs_resident_filters"),l=document.getElementById("marital_status_filters"),c=document.getElementById("home_owner_filters"),p=document.getElementById("risk_category_filters"),_=document.getElementById("household_income_filters"),d=document.getElementById("directors_filters"),u=document.getElementById("vehicle_owner_filters"),g=document.getElementById("lsm_group_filters"),h=document.getElementById("property_valuation_filters"),m=document.getElementById("property_count_bucket_filters");e.childNodes.length>1||t.childNodes.length>1||a.childNodes.length>1||r.childNodes.length>1||i.childNodes.length>1||o.childNodes.length>1||n.childNodes.length>1||s.childNodes.length>1||l.childNodes.length>1||c.childNodes.length>1||p.childNodes.length>1||_.childNodes.length>1||d.childNodes.length>1||u.childNodes.length>1||g.childNodes.length>1||h.childNodes.length>1||m.childNodes.length>1?$("#no_filters").hide():$("#no_filters").show(),e.childNodes.length>1?$("#province_filters").show():$("#province_filters").hide(),t.childNodes.length>1?$("#municipality_filters").show():$("#municipality_filters").hide(),a.childNodes.length>1?$("#area_filters").show():$("#area_filters").hide(),r.childNodes.length>1?$("#age_filters").show():$("#age_filters").hide(),i.childNodes.length>1?$("#gender_filters").show():$("#gender_filters").hide(),o.childNodes.length>1?$("#population_group_filters").show():$("#population_group_filters").hide(),n.childNodes.length>1?$("#generation_filters").show():$("#generation_filters").hide(),s.childNodes.length>1?$("#citizen_vs_resident_filters").show():$("#citizen_vs_resident_filters").hide(),l.childNodes.length>1?$("#marital_status_filters").show():$("#marital_status_filters").hide(),c.childNodes.length>1?$("#home_owner_filters").show():$("#home_owner_filters").hide(),p.childNodes.length>1?$("#risk_category_filters").show():$("#risk_category_filters").hide(),_.childNodes.length>1?$("#household_income_filters").show():$("#household_income_filters").hide(),d.childNodes.length>1?$("#directors_filters").show():$("#directors_filters").hide(),u.childNodes.length>1?$("#vehicle_owner_filters").show():$("#vehicle_owner_filters").hide(),g.childNodes.length>1?$("#lsm_group_filters").show():$("#lsm_group_filters").hide(),h.childNodes.length>1?$("#property_valuation_filters").show():$("#property_valuation_filters").hide(),m.childNodes.length>1?$("#property_count_bucket_filters").show():$("#property_count_bucket_filters").hide()};function kFormatter(e){var t,a=[{value:1,symbol:""},{value:1e3,symbol:"k"},{value:1e6,symbol:"M"},{value:1e9,symbol:"G"},{value:1e12,symbol:"T"},{value:1e15,symbol:"P"},{value:1e18,symbol:"E"}];for(t=a.length-1;t>0&&!(e>=a[t].value);t--);return(e/a[t].value).toFixed(1).replace(/\.0+$|(\.[0-9]*[1-9])0+$/,"$1")+a[t].symbol}function drawProvinceChart(e){$("#province-graph .spinner-block").hide();var t=new google.visualization.DataTable;t.addColumn("string","Province"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e).map(function(t){var a;switch(e[t].province){case"G":a=["Gauteng",e[t].audience,kFormatter(e[t].audience)];break;case"EC":a=["Eastern Cape",e[t].audience,kFormatter(e[t].audience)];break;case"NC":a=["Northern Cape",e[t].audience,kFormatter(e[t].audience)];break;case"FS":a=["Free State",e[t].audience,kFormatter(e[t].audience)];break;case"L":a=["Limpopo",e[t].audience,kFormatter(e[t].audience)];break;case"KN":a=["KwaZulu Natal",e[t].audience,kFormatter(e[t].audience)];break;case"M":a=["Mpumalanga",e[t].audience,kFormatter(e[t].audience)];break;case"NW":a=["North West",e[t].audience,kFormatter(e[t].audience)];break;case"WC":a=["Western Cape",e[t].audience,kFormatter(e[t].audience)];break;default:a=[e[t].province,e[t].audience,kFormatter(e[t].audience)]}return a});t.addRows(a);new google.visualization.BarChart(document.getElementById("provincesChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},legend:{position:"none"},backgroundColor:"#f7f7f7",colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"}}),update_progress()}function drawAreaChart(){$.get("/api/meetpat-client/get-records/areas",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_owners:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#area-graph .spinner-block").hide(),$("#area-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#area_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#area-graph .spinner-block").hide(),$("#areaSubmitBtn").prop("disabled",!1),$("#area_filter").append('<div id="lunr-search" style="display: none;"><input type="text" class="form-control mb-2" id="areaSearchInput" autocomplete="off" placeholder="search for area..."><span style="position:absolute; right: 40px; top:35px;"><i class="fas fa-search"></i></span><ul id="lunr-results" class="list-unstyled"></ul></div>');var t=new google.visualization.DataTable;t.addColumn("string","Area"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].area,e.all[t].audience,kFormatter(e.all[t].audience)]}).slice(0,20);t.addRows(a);var r={width:"100%",height:25*a.length,fontSize:10,chartArea:{top:"20",top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],legend:{position:"none"},backgroundColor:"#f7f7f7"};new google.visualization.BarChart(document.getElementById("areasChart")).draw(t,r);var i=Object.keys(e.all).map(function(t){return{name:e.all[t].area,count:kFormatter(e.all[t].audience)}}),o=i,n=lunr(function(){this.ref("name"),this.field("name"),this.k1(1.5),this.b(.25),o.forEach(function(e){this.add(e)},this)});$("#lunr-search").show(),$("#area-filter-form .text-center").remove(),a.forEach(function(e){$("#area_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length?($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+kFormatter(i.filter(t=>{if(t.name===e[0])return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").is(":checked")){var t=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e[0]+'" checked="checked"><small> '+kFormatter(i.filter(t=>{if(t.name===e[0])return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+" i").click(function(){$("#area_hidden_"+$(t).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length&&($("#filter_area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove(),$("#area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove());checkForFilters()})):($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+kFormatter(i.filter(t=>{if(t.name===e[0])return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").is(":checked")){var t=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+" i").click(function(){$("#area_hidden_"+$(t).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length&&($("#filter_area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove(),$("#area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove());checkForFilters()}))}),document.getElementById("areaSearchInput").addEventListener("keyup",function(){n.search(this.value+"*").length&&""!=this.value?($("#lunr-results").empty(),n.search(this.value+"*").forEach(function(e){e.score&&($("#area_hidden_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length?($("#lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox" checked="checked"><label for="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+kFormatter(i.filter(t=>{if(t.name===e.ref)return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").is(":checked")){var t=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e.ref+'" checked="checked"><small> '+kFormatter(i.filter(t=>{if(t.name===e.ref)return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+" i").click(function(){$("#area_hidden_"+$(t).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length&&($("#filter_area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove(),$("#area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove());checkForFilters()})):($("#lunr-results").append('<input type="checkbox" name="'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e.ref+'" class="css-checkbox"><label for="area_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e.ref+"<small> "+kFormatter(i.filter(t=>{if(t.name===e.ref)return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_"+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").is(":checked")){var t=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_hidden_'+e.ref.toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e.ref+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+" i").click(function(){$("#area_hidden_"+$(t).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length&&($("#filter_area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove(),$("#area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove());checkForFilters()})))})):($("#lunr-results").empty(),a.forEach(function(e){$("#area_hidden_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length?($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox" checked="checked"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+kFormatter(i.filter(t=>{if(t.name===e[0])return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").is(":checked")){var t=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e[0]+'" checked="checked"><small> '+kFormatter(i.filter(t=>{if(t.name===e[0])return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+" i").click(function(){$("#area_hidden_"+$(t).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length&&($("#filter_area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove(),$("#area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove());checkForFilters()})):($("#lunr-results").append('<input type="checkbox" name="'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0]+'" class="css-checkbox"><label for="area_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" class="css-label">'+e[0]+"<small> "+kFormatter(i.filter(t=>{if(t.name===e[0])return t.count}).map(function(e){return e.count})[0])+"</small></label><br />"),$("#area_"+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").click(function(){if($("#area_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").is(":checked")){var t=this;$("#hidden-area-filter-form").append('<input type="checkbox" name="hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'" id="area_hidden_'+e[0].toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'_option" value="'+e[0]+'" checked="checked">'),$("#area_filters").append('<li id="filter_area_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+" i").click(function(){$("#area_hidden_"+$(t).attr("name").toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").length&&($("#filter_area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove(),$("#area_"+$(t).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,""))&&($("#filter_area_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")).remove(),$("#area_hidden_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/[\'&()]/g,"")+"_option").remove());checkForFilters()}))}))}),update_progress()})}var drawMunicipalityChart=function(e){$("#municipality-graph .spinner-block").hide();var t=new google.visualization.DataTable;t.addColumn("string","Municipality"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].municipality,e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);var r={height:25*a.length,width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"};for(var i in e.distinct)target_municipalities.includes(e.distinct[i].municipality)?$("#municipality_filter").append('<input type="checkbox" name="'+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'" id="municipality_'+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" value="'+e.distinct[i].municipality+'" class="css-checkbox" checked="checked"><label for="municipality_'+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" class="css-label">'+e.distinct[i].municipality+"</label><br />"):$("#municipality_filter").append('<input type="checkbox" name="'+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'" id="municipality_'+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" value="'+e.distinct[i].municipality+'" class="css-checkbox"><label for="municipality_'+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'_option" class="css-label">'+e.distinct[i].municipality+"</label><br />"),$("#municipality_"+e.distinct[i].municipality.toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").click(function(){if($("#municipality_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").is(":checked")){var e=this;$("#municipality_filters").append('<li id="filter_municipality_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_municipality_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+" i").click(function(){$("#municipality_"+$(e).attr("name").toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").length&&($("#filter_municipality_"+$(e).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")).remove(),$("#municipality_"+$(e).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_municipality_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_"))&&$("#filter_municipality_"+$(this).val().toLowerCase().replace(/ /g,"_").replace(/\./g,"_")).remove();checkForFilters()});new google.visualization.BarChart(document.getElementById("municipalityChart")).draw(t,r),drawAreaChart()},drawMapChart=function(e){$("#map-graph .spinner-block").hide();var t=Object.keys(e).map(function(t){var a;switch(e[t].province){case"G":a=["ZA-GT",e[t].audience,'<ul class="list-unstyled"><li><b>Gauteng</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"WC":a=["ZA-WC",e[t].audience,'<ul class="list-unstyled"><li><b>Western Cape</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"EC":a=["ZA-EC",e[t].audience,'<ul class="list-unstyled"><li><b>Eastern Cape</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"M":a=["ZA-MP",e[t].audience,'<ul class="list-unstyled"><li><b>Mpumalanga</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"FS":a=["ZA-FS",e[t].audience,'<ul class="list-unstyled"><li><b>Free State</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"L":a=["ZA-LP",e[t].audience,'<ul class="list-unstyled"><li><b>Limpopo</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"KN":a=["ZA-NL",e[t].audience,'<ul class="list-unstyled"><li><b>KwaZula Natal</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"NW":a=["ZA-NW",e[t].audience,'<ul class="list-unstyled"><li><b>North West Province</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;case"NC":a=["ZA-NC",e[t].audience,'<ul class="list-unstyled"><li><b>Northern Cape</b></li><li>'+kFormatter(e[t].audience)+"</li></ul>"];break;default:a=""}return a});t.unshift(["Provinces","Popularity",{role:"tooltip",p:{html:!0}}]);var a=t.filter(function(e){return""!=e}),r=google.visualization.arrayToDataTable(a);new google.visualization.GeoChart(document.getElementById("chartdiv")).draw(r,{region:"ZA",resolution:"provinces",backgroundColor:"#f7f7f7",colorAxis:{colors:["#039be5"]},tooltip:{isHtml:!0}}),update_progress()},drawAgeChart=function(){$.get("/api/meetpat-client/get-records/ages",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#age-graph .spinner-block").hide(),$("#age-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#age_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#age-graph .spinner-block").hide(),$("#age_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Age"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].ageGroup,e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_ages.includes(e.distinct[r].ageGroup)?$("#age_filter").append('<input type="checkbox" name="'+e.distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'" id="age_'+e.distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" value="'+e.distinct[r].ageGroup+'" class="css-checkbox" checked="checked"><label for="age_'+e.distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" class="css-label">'+e.distinct[r].ageGroup+"</label><br />"):$("#age_filter").append('<input type="checkbox" name="'+e.distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'" id="age_'+e.distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" value="'+e.distinct[r].ageGroup+'" class="css-checkbox"><label for="age_'+e.distinct[r].ageGroup.toLowerCase().replace(/ /g,"_").replace("+","plus")+'_option" class="css-label">'+e.distinct[r].ageGroup+"</label><br />"),$("#age_"+e.distinct[r].ageGroup.toLowerCase()+"_option").click(function(){if($("#age_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus")+"_option").is(":checked")){var e=this;$("#age_filters").append('<li id="filter_age_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_age_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus")+" i").click(function(){$("#age_"+$(e).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus")+"_option").length&&($("#filter_age_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("+","plus")).remove(),$("#age_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("+","plus")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_age_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus"))&&$("#filter_age_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus")).remove();checkForFilters()});new google.visualization.BarChart(document.getElementById("agesChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawPropertyValuationChart=function(){$.get("/api/meetpat-client/get-records/property-valuation",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#property-valuation-graph .spinner-block").hide(),$("#property-valuation-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#property_valuation_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#property-valuation-graph .spinner-block").hide(),$("#property_valuation_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Property Valuation"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[keyChangerPrValBucket(e.all[t].propertyValuationBucket),e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_property_valuations.includes(e.distinct[r].propertyValuationBucket)?$("#property_valuation_filter").append('<input type="checkbox" name="'+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","").replace("-","")+'" id="property_valuations_'+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+'_option" value="'+e.distinct[r].propertyValuationBucket+'" class="css-checkbox" checked="checked"><label for="property_valuations_'+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+'_option" class="css-label">'+keyChangerPrValBucket(e.distinct[r].propertyValuationBucket)+"</label><br />"):$("#property_valuation_filter").append('<input type="checkbox" name="'+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+'" id="property_valuations_'+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+'_option" value="'+e.distinct[r].propertyValuationBucket+'" class="css-checkbox"><label for="property_valuations_'+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+'_option" class="css-label">'+keyChangerPrValBucket(e.distinct[r].propertyValuationBucket)+"</label><br />"),$("#property_valuations_"+e.distinct[r].propertyValuationBucket.toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+"_option").click(function(){if($("#property_valuations_"+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+"_option").is(":checked")){var e=this;$("#property_valuation_filters").append('<li id="filter_property_valuations_'+$(this).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_property_valuations_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+" i").click(function(){$("#property_valuations_"+$(e).attr("name").toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+"_option").length&&($("#filter_property_valuations_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")).remove(),$("#property_valuations_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_property_valuations_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-",""))&&$("#filter_property_valuations_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("+","plus").replace("-","")).remove();checkForFilters()});new google.visualization.BarChart(document.getElementById("propertyValuationChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawGenderChart=function(){var e=function(e){var t;switch(e){case"M":t="Male";break;case"F":t="Female";break;default:t="Unkown"}return t};$.get("/api/meetpat-client/get-records/genders",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#gender-graph .spinner-block").hide(),$("#gender-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#gender_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(t){$("#gender-graph .spinner-block").hide(),$("#gender_filter").empty();var a=new google.visualization.DataTable;a.addColumn("string","Gender"),a.addColumn("number","Records"),a.addColumn({type:"string",role:"annotation"});var r=Object.keys(t.all).map(function(e){return[keyChangerGender(t.all[e].gender),t.all[e].audience,kFormatter(t.all[e].audience)]});a.addRows(r);for(var i in t.distinct)target_genders.includes(t.distinct[i].gender)?$("#gender_filter").append('<input type="checkbox" name="g_'+t.distinct[i].gender+'" id="g_'+t.distinct[i].gender.toLowerCase()+'_option" value="'+t.distinct[i].gender+'" class="css-checkbox" checked="checked"><label for="g_'+t.distinct[i].gender.toLowerCase()+'_option" class="css-label">'+e(t.distinct[i].gender)+"</label><br />"):$("#gender_filter").append('<input type="checkbox" name="g_'+t.distinct[i].gender+'" id="g_'+t.distinct[i].gender.toLowerCase()+'_option" value="'+t.distinct[i].gender+'" class="css-checkbox"><label for="g_'+t.distinct[i].gender.toLowerCase()+'_option" class="css-label">'+e(t.distinct[i].gender)+"</label><br />"),$("#g_"+t.distinct[i].gender.toLowerCase()+"_option").click(function(){if($("#g_"+$(this).val().toLowerCase()+"_option").is(":checked")){var t=this;$("#gender_filters").append('<li id="filter_g_'+$(this).val().toLowerCase()+'">'+e($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_g_"+$(this).val().toLowerCase()+" i").click(function(){$("#g_"+$(t).val().toLowerCase()+"_option").length&&($("#filter_g_"+$(t).val().toLowerCase()).remove(),$("#g_"+$(t).val().toLowerCase()+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_g_"+$(this).val().toLowerCase())&&$("#filter_g_"+$(this).val().toLowerCase()).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("genderChart")).draw(a,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawPopulationChart=function(){var e=function(e){switch(e){case"B":return"Black";case"W":return"White";case"C":return"Coloured";case"A":return"Asian";default:return"Unkown"}};$.get("/api/meetpat-client/get-records/population-groups",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_owners:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#population-graph .spinner-block").hide(),$("#population-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#population_group_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(t){$("#population-graph .spinner-block").hide(),$("#population_group_filter").empty();var a=new google.visualization.DataTable;a.addColumn("string","Group"),a.addColumn("number","Records"),a.addColumn({type:"string",role:"annotation"});var r=Object.keys(t.all).map(function(a){return[e(t.all[a].populationGroup),t.all[a].audience,kFormatter(t.all[a].audience)]});a.addRows(r);for(var i in t.distinct)target_population_groups.includes(t.distinct[i].populationGroup)?$("#population_group_filter").append('<input type="checkbox" name="pop_'+t.distinct[i].populationGroup+'" id="pop_'+t.distinct[i].populationGroup.toLowerCase()+'_option" value="'+t.distinct[i].populationGroup+'" class="css-checkbox" checked="checked"><label for="pop_'+t.distinct[i].populationGroup.toLowerCase()+'_option" class="css-label">'+e(t.distinct[i].populationGroup)+"</label><br />"):$("#population_group_filter").append('<input type="checkbox" name="pop_'+t.distinct[i].populationGroup+'" id="pop_'+t.distinct[i].populationGroup.toLowerCase()+'_option" value="'+t.distinct[i].populationGroup+'" class="css-checkbox"><label for="pop_'+t.distinct[i].populationGroup.toLowerCase()+'_option" class="css-label">'+e(t.distinct[i].populationGroup)+"</label><br />"),$("#pop_"+t.distinct[i].populationGroup.toLowerCase()+"_option").click(function(){if($("#pop_"+$(this).val().toLowerCase()+"_option").is(":checked")){var t=this;$("#population_group_filters").append('<li id="filter_pop_'+$(this).val().toLowerCase()+'">'+e($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_pop_"+$(this).val().toLowerCase()+" i").click(function(){$("#pop_"+$(t).val().toLowerCase()+"_option").length&&($("#filter_pop_"+$(t).val().toLowerCase()).remove(),$("#pop_"+$(t).val().toLowerCase()+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_pop_"+$(this).val().toLowerCase())&&$("#filter_pop_"+$(this).val().toLowerCase()).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("populationGroupChart")).draw(a,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawGenerationChart=function(){$.get("/api/meetpat-client/get-records/generations",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#generation-graph .spinner-block").hide(),$("#generation-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#generation_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#generation-graph .spinner-block").hide(),$("#generation_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Generation"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].generation,e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_generations.includes(e.distinct[r].generation)?$("#generation_filter").append('<input type="checkbox" name="gen_'+e.distinct[r].generation+'" id="gen_'+e.distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" value="'+e.distinct[r].generation+'" class="css-checkbox" checked="checked"><label for="gen_'+e.distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" class="css-label">'+e.distinct[r].generation+"</label><br />"):$("#generation_filter").append('<input type="checkbox" name="gen_'+e.distinct[r].generation+'" id="gen_'+e.distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" value="'+e.distinct[r].generation+'" class="css-checkbox"><label for="gen_'+e.distinct[r].generation.toLowerCase().replace(/ /g,"_")+'_option" class="css-label">'+e.distinct[r].generation+"</label><br />"),$("#gen_"+e.distinct[r].generation.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#gen_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#generation_filters").append('<li id="filter_gen_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_gen_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#gen_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_gen_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#gen_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_gen_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_gen_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("generationChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawCitizensChart=function(){$.get("/api/meetpat-client/get-records/citizens-and-residents",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#c-vs-r-graph .spinner-block").hide(),$("#c-vs-r-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#citizen_vs_resident_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#c-vs-r-graph .spinner-block").hide(),$("#citizen_vs_resident_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Citizen or Resident"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e).map(function(t){return[t,e[t],kFormatter(e[t])]});t.addRows(a);target_citizen_vs_residents.includes("citizen")?$("#citizen_vs_resident_filter").append('<input type="checkbox" name="citizen" id="citizen_option" value="citizen" class="css-checkbox" checked="checked"><label for="citizen_option" class="css-label">Citizen</label><br />'):$("#citizen_vs_resident_filter").append('<input type="checkbox" name="citizen" id="citizen_option" value="citizen" class="css-checkbox"><label for="citizen_option" class="css-label">Citizen</label><br />'),target_citizen_vs_residents.includes("resident")?$("#citizen_vs_resident_filter").append('<input type="checkbox" name="resident" id="resident_option" value="resident" class="css-checkbox" checked="checked"><label for="resident_option" class="css-label">Resident</label><br />'):$("#citizen_vs_resident_filter").append('<input type="checkbox" name="resident" id="resident_option" value="resident" class="css-checkbox"><label for="resident_option" class="css-label">Resident</label><br />'),$("#citizen_option").click(function(){$("#citizen_option").is(":checked")?($("#generation_filters").append('<li id="filter_citizen_option">Citizen<i class="fas fa-window-close float-right"></i></li>'),$("#filter_citizen_option i").click(function(){$("#filter_citizen_option")&&($("#filter_citizen_option").remove(),$("#citizen_option").prop("checked",!1)),checkForFilters()})):$("#filter_citizen_option")&&$("#filter_citizen_option").remove(),checkForFilters()}),$("#resident_option").click(function(){$("#resident_option").is(":checked")?($("#generation_filters").append('<li id="filter_resident_option">Resident<i class="fas fa-window-close float-right"></i></li>'),$("#filter_resident_option i").click(function(){$("#filter_resident_option")&&($("#filter_resident_option").remove(),$("#resident_option").prop("checked",!1)),checkForFilters()})):$("#filter_resident_option")&&$("#filter_resident_option").remove(),checkForFilters()}),new google.visualization.ColumnChart(document.getElementById("citizensVsResidentsChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawMaritalStatusChart=function(){$.get("/api/meetpat-client/get-records/marital-statuses",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#marital-status-graph .spinner-block").hide(),$("#marital-status-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#marital_status_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#marital-status-graph .spinner-block").hide(),$("#marital_status_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Marital Status"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[keyChangerMaritalStatus(e.all[t].maritalStatus),e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_marital_statuses.includes(e.distinct[r].maritalStatus.toLowerCase())?$("#marital_status_filter").append('<input type="checkbox" name="m_'+e.distinct[r].maritalStatus.toLowerCase()+'" id="m_'+e.distinct[r].maritalStatus.toLowerCase()+'_option" value="'+e.distinct[r].maritalStatus.toLowerCase()+'" class="css-checkbox" checked="checked"><label for="m_'+e.distinct[r].maritalStatus.toLowerCase()+'_option" class="css-label">'+keyChangerMaritalStatus(e.distinct[r].maritalStatus)+"</label><br />"):$("#marital_status_filter").append('<input type="checkbox" name="m_'+e.distinct[r].maritalStatus.toLowerCase()+'" id="m_'+e.distinct[r].maritalStatus.toLowerCase()+'_option" value="'+e.distinct[r].maritalStatus.toLowerCase()+'" class="css-checkbox"><label for="m_'+e.distinct[r].maritalStatus.toLowerCase()+'_option" class="css-label">'+keyChangerMaritalStatus(e.distinct[r].maritalStatus)+"</label><br />"),$("#m_"+e.distinct[r].maritalStatus.toLowerCase()+"_option").click(function(){if($("#m_"+$(this).val().toLowerCase()+"_option").is(":checked")){var e=this;$("#marital_status_filters").append('<li id="filter_m_'+$(this).val().toLowerCase()+'">'+keyChangerMaritalStatus($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_m_"+$(this).val().toLowerCase()+" i").click(function(){$("#m_"+$(e).val().toLowerCase()+"_option").length&&($("#filter_m_"+$(e).val().toLowerCase()).remove(),$("#m_"+$(e).val().toLowerCase()+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_m_"+$(this).val().toLowerCase())&&$("#filter_m_"+$(this).val().toLowerCase()).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("maritalStatusChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawHomeOwnerChart=function(){$.get("/api/meetpat-client/get-records/home-owner",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#home-owner-graph .spinner-block").hide(),$("#home-owner-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#home_owner_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#home-owner-graph .spinner-block").hide(),$("#home_owner_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Home Owner Status"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[keyChanger(e.all[t].homeOwnershipStatus),e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_home_owners.includes(e.distinct[r].homeOwnershipStatus.toLowerCase())?$("#home_owner_filter").append('<input type="checkbox" name="h_'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'" id="h_'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'_option" value="'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'" class="css-checkbox" checked="checked"><label for="h_'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'_option" class="css-label">'+keyChanger(e.distinct[r].homeOwnershipStatus)+"</label><br />"):$("#home_owner_filter").append('<input type="checkbox" name="h_'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'" id="h_'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'_option" value="'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'" class="css-checkbox"><label for="h_'+e.distinct[r].homeOwnershipStatus.toLowerCase()+'_option" class="css-label">'+keyChanger(e.distinct[r].homeOwnershipStatus)+"</label><br />"),$("#h_"+e.distinct[r].homeOwnershipStatus.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#h_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#home_owner_filters").append('<li id="filter_h_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+keyChanger($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_h_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#h_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_h_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#h_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_h_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_h_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("homeOwnerChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawpropertyCountBucketChart=function(){$.get("/api/meetpat-client/get-records/property-count-bucket",{user_id:user_id_number,province:target_provinces.join(","),age:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){console.log(e),$("#property-count-bucket-graph .spinner-block").hide(),$("#property-count-bucket-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#property_count_bucket_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>')}).done(function(e){$("#property-count-bucket-graph .spinner-block").hide(),$("#property_count_bucket_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Property Count"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].propertyCountBucket,e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_home_owners.includes(e.distinct[r].propertyCountBucket)?$("#property_count_bucket_filter").append('<input type="checkbox" name="pc_'+e.distinct[r].propertyCountBucket.toLowerCase()+'" id="pc_'+e.distinct[r].propertyCountBucket.toLowerCase()+'_option" value="'+e.distinct[r].propertyCountBucket.toLowerCase()+'" class="css-checkbox" checked="checked"><label for="pc_'+e.distinct[r].propertyCountBucket.toLowerCase()+'_option" class="css-label">'+e.distinct[r].propertyCountBucket.toLowerCase()+"</label><br />"):$("#property_count_bucket_filter").append('<input type="checkbox" name="pc_'+e.distinct[r].propertyCountBucket.toLowerCase()+'" id="pc_'+e.distinct[r].propertyCountBucket.toLowerCase()+'_option" value="'+e.distinct[r].propertyCountBucket.toLowerCase()+'" class="css-checkbox"><label for="pc_'+e.distinct[r].propertyCountBucket.toLowerCase()+'_option" class="css-label">'+e.distinct[r].propertyCountBucket.toLowerCase()+"</label><br />"),$("#pc_"+e.distinct[r].propertyCountBucket.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#pc_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#property_count_bucket_filters").append('<li id="filter_pc_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_pc_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#pc_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_pc_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#pc_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_pc_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_pc_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("propertyCountBucketChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawVehicleOwnerChart=function(){$.get("/api/meetpat-client/get-records/vehicle-owner",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){console.log(e),$("#vehicle-owner-graph .spinner-block").hide(),$("#vehicle-owner-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#vehicle_owner_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>')}).done(function(e){$("#vehicle-owner-graph .spinner-block").hide(),$("#vehicle_owner_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Vehicle Owner Status"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[keyChanger(e.all[t].vehicleOwnershipStatus),e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_vehicle_owners.includes(e.distinct[r].vehicleOwnershipStatus.toLowerCase())?$("#vehicle_owner_filter").append('<input type="checkbox" name="vo_'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'" id="vo_'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'_option" value="'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'" class="css-checkbox" checked="checked"><label for="vo_'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'_option" class="css-label">'+keyChanger(e.distinct[r].vehicleOwnershipStatus)+"</label><br />"):$("#vehicle_owner_filter").append('<input type="checkbox" name="vo_'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'" id="vo_'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'_option" value="'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'" class="css-checkbox"><label for="vo_'+e.distinct[r].vehicleOwnershipStatus.toLowerCase()+'_option" class="css-label">'+keyChanger(e.distinct[r].vehicleOwnershipStatus)+"</label><br />"),$("#vo_"+e.distinct[r].vehicleOwnershipStatus.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#vo_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#vehicle_owner_filters").append('<li id="filter_vo_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+keyChanger($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_vo_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#vo_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_vo_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#vo_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_vo_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_vo_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("vehicleOwnerChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawLSMGroupChart=function(){$.get("/api/meetpat-client/get-records/lsm-group",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#lsm-group-graph .spinner-block").hide(),$("#lsm-group-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#lsm_group_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#lsm-group-graph .spinner-block").hide(),$("#lsm_group_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","LSM Group"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].lsmGroup,e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_lsm_groups.includes(e.distinct[r].lsmGroup)?$("#lsm_group_filter").append('<input type="checkbox" name="lsm_'+e.distinct[r].lsmGroup.toLowerCase()+'" id="lsm_'+e.distinct[r].lsmGroup.toLowerCase()+'_option" value="'+e.distinct[r].lsmGroup.toLowerCase()+'" class="css-checkbox" checked="checked"><label for="lsm_'+e.distinct[r].lsmGroup.toLowerCase()+'_option" class="css-label">'+e.distinct[r].lsmGroup.toLowerCase()+"</label><br />"):$("#lsm_group_filter").append('<input type="checkbox" name="lsm_'+e.distinct[r].lsmGroup.toLowerCase()+'" id="lsm_'+e.distinct[r].lsmGroup.toLowerCase()+'_option" value="'+e.distinct[r].lsmGroup.toLowerCase()+'" class="css-checkbox"><label for="lsm_'+e.distinct[r].lsmGroup.toLowerCase()+'_option" class="css-label">'+e.distinct[r].lsmGroup.toLowerCase()+"</label><br />"),$("#lsm_"+e.distinct[r].lsmGroup.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#lsm_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#lsm_group_filters").append('<li id="filter_lsm_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_lsm_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#lsm_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_lsm_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#lsm_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_lsm_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_lsm_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.BarChart(document.getElementById("lsmGroupChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawRiskCategoryChart=function(){$.get("/api/meetpat-client/get-records/risk-category",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#risk-category-graph .spinner-block").hide(),$("#risk-category-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#risk_category_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#risk-category-graph .spinner-block").hide(),$("#risk_category_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Age"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[e.all[t].riskCategory,e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_risk_categories.includes(e.distinct[r].riskCategory)?$("#risk_category_filter").append('<input type="checkbox" name="r_'+e.distinct[r].riskCategory+'" id="r_'+e.distinct[r].riskCategory.toLowerCase()+'_option" value="'+e.distinct[r].riskCategory+'" class="css-checkbox" checked="checked"><label for="r_'+e.distinct[r].riskCategory.toLowerCase()+'_option" class="css-label">'+e.distinct[r].riskCategory+"</label><br />"):$("#risk_category_filter").append('<input type="checkbox" name="r_'+e.distinct[r].riskCategory+'" id="r_'+e.distinct[r].riskCategory.toLowerCase()+'_option" value="'+e.distinct[r].riskCategory+'" class="css-checkbox"><label for="r_'+e.distinct[r].riskCategory.toLowerCase()+'_option" class="css-label">'+e.distinct[r].riskCategory+"</label><br />"),$("#r_"+e.distinct[r].riskCategory.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#r_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#risk_category_filters").append('<li id="filter_r_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_r_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#r_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_r_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#r_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_r_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_r_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.BarChart(document.getElementById("riskCategoryChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"50%",height:"100%"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawHouseholdIncomeChart=function(){$.get("/api/meetpat-client/get-records/household-income",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#income-graph .spinner-block").hide(),$("#income-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#household_income_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#income-graph .spinner-block").hide(),$("#household_income_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Income"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[keyChangerHsIncBucket(e.all[t].incomeBucket),e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_incomes.includes(e.distinct[r].incomeBucket)?$("#household_income_filter").append('<input type="checkbox" name="hi_'+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'" id="hi_'+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" value="'+e.distinct[r].incomeBucket+'" class="css-checkbox" checked="checked"><label for="hi_'+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" class="css-label">'+keyChangerHsIncBucket(e.distinct[r].incomeBucket)+"</label><br />"):$("#household_income_filter").append('<input type="checkbox" name="hi_'+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'" id="hi_'+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" value="'+e.distinct[r].incomeBucket+'" class="css-checkbox"><label for="hi_'+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'_option" class="css-label">'+keyChangerHsIncBucket(e.distinct[r].incomeBucket)+"</label><br />"),$("#hi_"+e.distinct[r].incomeBucket.toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").click(function(){if($("#hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").is(":checked")){var e=this;$("#household_income_filters").append('<li id="filter_hi_'+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+'">'+$(this).val()+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+" i").click(function(){$("#hi_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").length&&($("#filter_hi_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")).remove(),$("#hi_"+$(e).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus"))&&$("#filter_hi_"+$(this).val().toLowerCase().replace(/ /g,"_").replace("-","").replace("+","plus")).remove();checkForFilters()});new google.visualization.BarChart(document.getElementById("householdIncomeChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress()})},drawDirectorOfBusinessChart=function(){$.get("/api/meetpat-client/get-records/director-of-business",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#directors-graph .spinner-block").hide(),$("#directors-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#directors_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#directors-graph .spinner-block").hide(),$("#directors_filter").empty();var t=new google.visualization.DataTable;t.addColumn("string","Director of Business"),t.addColumn("number","Records"),t.addColumn({type:"string",role:"annotation"});var a=Object.keys(e.all).map(function(t){return[keyChanger(e.all[t].directorshipStatus),e.all[t].audience,kFormatter(e.all[t].audience)]});t.addRows(a);for(var r in e.distinct)target_directors.includes(e.distinct[r].directorshipStatus)?$("#directors_filter").append('<input type="checkbox" name="d_'+e.distinct[r].directorshipStatus+'" id="d_'+e.distinct[r].directorshipStatus.toLowerCase()+'_option" value="'+e.distinct[r].directorshipStatus+'" class="css-checkbox" checked="checked"><label for="d_'+e.distinct[r].directorshipStatus.toLowerCase()+'_option" class="css-label">'+keyChanger(e.distinct[r].directorshipStatus)+"</label><br />"):$("#directors_filter").append('<input type="checkbox" name="d_'+e.distinct[r].directorshipStatus+'" id="d_'+e.distinct[r].directorshipStatus.toLowerCase()+'_option" value="'+e.distinct[r].directorshipStatus+'" class="css-checkbox"><label for="d_'+e.distinct[r].directorshipStatus.toLowerCase()+'_option" class="css-label">'+keyChanger(e.distinct[r].directorshipStatus)+"</label><br />"),$("#d_"+e.distinct[r].directorshipStatus.toLowerCase().replace(/ /g,"_")+"_option").click(function(){if($("#d_"+$(this).val().toLowerCase().replace(/ /g,"_")+"_option").is(":checked")){var e=this;$("#directors_filters").append('<li id="filter_d_'+$(this).val().toLowerCase().replace(/ /g,"_")+'">'+keyChanger($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_d_"+$(this).val().toLowerCase().replace(/ /g,"_")+" i").click(function(){$("#d_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").length&&($("#filter_d_"+$(e).val().toLowerCase().replace(/ /g,"_")).remove(),$("#d_"+$(e).val().toLowerCase().replace(/ /g,"_")+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_d_"+$(this).val().toLowerCase().replace(/ /g,"_"))&&$("#filter_d_"+$(this).val().toLowerCase().replace(/ /g,"_")).remove();checkForFilters()});new google.visualization.ColumnChart(document.getElementById("directorOfBusinessChart")).draw(t,{width:"100%",fontSize:10,chartArea:{top:"20",width:"60%",height:"75%"},vAxis:{minValue:0,format:"short"},colors:["#00A3D9"],animation:{startup:!0,duration:1e3,easing:"out"},legend:{position:"none"},backgroundColor:"#f7f7f7"}),update_progress(),hide_progress(),$(".apply-filter-button").prop("disabled",!1),$(".apply-filter-button").html("apply"),$("#sidebarSubmitBtn").html('<i class="fas fa-sync-alt"></i>&nbsp;Apply Filters'),$("#sidebarSubmitBtn").prop("disabled",!1),$("#resetFilterToastBtn").prop("disabled",!1),$("#audienceSubmitBtn").prop("disabled",!1),$("#resetFilterToastBtn").html('<i class="fas fa-undo-alt"></i>&nbsp;Reset Filters'),$("#downloadSubmitBtn").prop("disabled",!1)})},get_records_count=function(e){var t=$("#records-main-toast .toast-body"),a=$("#records-toast .toast-body"),r=$("#contacts-num-sidebar"),i=$("#numberOfContactsId"),o=$("#eta_file_process");$.get("/api/meetpat-client/get-records/count",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#contacts-number .spinner-block").hide(),$("#contacts-number .toast-body").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){t.html(kFormatter(e)),r.html(kFormatter(e)),a.html(kFormatter(e)),i.val(e),e<1e5?o.html("30 seconds"):e>1e5&&e<3e5?o.html("a minute"):o.html("5 minutes or more"),$("#contacts-number .spinner-block").hide()})},set_records_count_progress_text=function(){var e=$("#attributes_placeholder"),t=$("#records_placeholder");$.get("/api/meetpat-client/get-records/count",{user_id:user_id_number},function(e){}).fail(function(e){$("#contacts-number .spinner-block").hide(),$("#contacts-number .toast-body").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(a){$("#progress_popup").show(),e.html(kFormatter(17*a)),t.html(kFormatter(a)),$("#contacts-number .spinner-block").hide()})},get_municipalities=function(){$.get("/api/meetpat-client/get-records/municipalities",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){$("#municipality-graph .spinner-block").hide(),$("#municipality-graph .graph-container").append('<div class="p-3"><p><i class="fas fa-exclamation-circle text-danger"></i> There was a problem fetching the data. The connection might have been lost.</p><p>If the problem persists please contact MeetPAT Support.</p></div>'),$("#municipality_filter").html('<i class="fas fa-exclamation-circle text-danger"></i>'),console.log(e)}).done(function(e){$("#municipality-graph .spinner-block").hide(),$("#municipality_filter").empty(),drawMunicipalityChart(e),update_progress(),get_ages()})},get_provinces=function(){get_records_count(),$.get("/api/meetpat-client/get-records/provinces",{user_id:user_id_number,province:target_provinces.join(","),age_group:target_ages.join(","),gender:target_genders.join(","),population_group:target_population_groups.join(","),generation:target_generations.join(","),marital_status:target_marital_statuses.join(","),home_ownership_status:target_home_owners.join(","),risk_category:target_risk_categories.join(","),income_bucket:target_incomes.join(","),directorship_status:target_directors.join(","),citizen_vs_resident:target_citizen_vs_residents.join(","),municipality:target_municipalities.join(","),area:target_areas.join(","),vehicle_ownership_status:target_vehicle_owners.join(","),property_valuation_bucket:target_property_valuations.join(","),lsm_group:target_lsm_groups.join(","),property_count_bucket:target_property_count_buckets.join(",")},function(e){}).fail(function(e){console.log(e)}).done(function(e){$("#province_filter").empty();var t=function(e){var t;switch(e){case"G":t="Gauteng";break;case"WC":t="Western Cape";break;case"EC":t="Eastern Cape";break;case"M":t="Mpumalanga";break;case"NW":t="North West";break;case"FS":t="Free State";break;case"L":t="Limpopo";break;case"KN":t="KwaZulu Natal";break;case"NC":t="Northern Cape";break;default:t="Unknown"}return t};for(var a in e.distinct)target_provinces.includes(e.distinct[a].province)?$("#province_filter").append('<input type="checkbox" name="'+e.distinct[a].province+'" id="'+e.distinct[a].province.toLowerCase()+'_option" value="'+e.distinct[a].province+'" class="css-checkbox" checked="checked"><label for="'+e.distinct[a].province.toLowerCase()+'_option" class="css-label">'+t(e.distinct[a].province)+"</label><br />"):$("#province_filter").append('<input type="checkbox" name="'+e.distinct[a].province+'" id="'+e.distinct[a].province.toLowerCase()+'_option" value="'+e.distinct[a].province+'" class="css-checkbox"><label for="'+e.distinct[a].province.toLowerCase()+'_option" class="css-label">'+t(e.distinct[a].province)+"</label><br />"),$("#"+e.distinct[a].province.toLowerCase()+"_option").click(function(){if($("#"+$(this).attr("name").toLowerCase()+"_option").is(":checked")){var e=this;$("#province_filters").append('<li id="filter_p_'+$(this).attr("name").toLowerCase()+'">'+t($(this).val())+'<i class="fas fa-window-close float-right"></i></li>'),$("#filter_p_"+$(this).val().toLowerCase()+" i").click(function(){$("#"+$(e).val().toLowerCase()+"_option").length&&($("#filter_p_"+$(e).val().toLowerCase()).remove(),$("#"+$(e).val().toLowerCase()+"_option").prop("checked",!1)),checkForFilters()})}else $("#filter_p_"+$(this).val().toLowerCase())&&$("#filter_p_"+$(this).val().toLowerCase()).remove();checkForFilters()});drawProvinceChart(e.all),drawMapChart(e.all),get_municipalities()})},get_ages=function(){drawAgeChart(),get_genders()},get_genders=function(){drawGenderChart(),get_population_groups()},get_population_groups=function(){drawPopulationChart(),get_generations()},get_generations=function(){drawGenerationChart(),get_citizens_and_residents()},get_home_owner=function(){drawHomeOwnerChart(),get_property_valuation()},get_property_valuation=function(){drawPropertyValuationChart(),get_property_count_bucket()},get_property_count_bucket=function(){drawpropertyCountBucketChart(),get_vehicle_owner()},get_vehicle_owner=function(){drawVehicleOwnerChart(),get_risk_category()},get_household_income=function(){drawHouseholdIncomeChart(),get_director_of_business()},get_risk_category=function(){drawRiskCategoryChart(),get_lsm_group()},get_lsm_group=function(){drawLSMGroupChart(),get_household_income()},get_director_of_business=function(){drawDirectorOfBusinessChart()},get_citizens_and_residents=function(){drawCitizensChart(),get_marital_statuses()},get_marital_statuses=function(){drawMaritalStatusChart(),get_home_owner()},apply_filters=function(){$("#province-graph .spinner-block").show(),$("#provincesChart").empty(),$("#province_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#municipality-graph .spinner-block").show(),$("#municipalityChart").empty(),$("#map-graph .spinner-block").show(),$("#chartdiv").empty(),$("#area-graph .spinner-block").show(),$("#areasChart").empty(),$("#area_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#age-graph .spinner-block").show(),$("#agesChart").empty(),$("#age_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#gender-graph .spinner-block").show(),$("#genderChart").empty(),$("#gender_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#population-graph .spinner-block").show(),$("#populationGroupChart").empty(),$("#population_group_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#generation-graph .spinner-block").show(),$("#generationChart").empty(),$("#generation_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#c-vs-r-graph .spinner-block").show(),$("#citizensVsResidentsChart").empty(),$("#citizen_vs_resident_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#marital-status-graph .spinner-block").show(),$("#maritalStatusChart").empty(),$("#marital_status_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#home-owner-graph .spinner-block").show(),$("#homeOwnerChart").empty(),$("#home_owner_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#risk-category-graph .spinner-block").show(),$("#riskCategoryChart").empty(),$("#risk_category_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#income-graph .spinner-block").show(),$("#householdIncomeChart").empty(),$("#household_income_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#directors-graph .spinner-block").show(),$("#directorOfBusinessChart").empty(),$("#directors_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#vehicle-owner-graph .spinner-block").show(),$("#vehicleOwnerChart").empty(),$("#vehicle_owner_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#lsm-group-graph .spinner-block").show(),$("#lsmGroupChart").empty(),$("#lsm_group_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#property-valuation-graph .spinner-block").show(),$("#propertyValuationChart").empty(),$("#property_valuation_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#property-count-bucket-graph .spinner-block").show(),$("#propertyCountBucketChart").empty(),$("#property_count_bucket_filter").html('<div class="text-center"><div class="spinner-border mb-2" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#records-main-toast .toast-body").html('<div class="d-flex justify-content-center"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>'),$("#records-toast .toast-body").html('<div class="d-flex justify-content-center"><div class="spinner-border text-primary" role="status"><span class="sr-only">Loading...</span></div></div>')};$(".apply-filter-button, #sidebarSubmitBtn, #apply-toggle-button").click(function(){window.scrollTo(0,0),checkForFilters(),data_fetched=0,$("#progress_popup .progress-bar").width("0%"),$("#progress_popup").show(),$(".apply-filter-button").prop("disabled",!0),$("#sidebarSubmitBtn").prop("disabled",!0),$("#audienceSubmitBtn").prop("disabled",!0),$(".apply-filter-button").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;applying...'),$("#sidebarSubmitBtn").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Applying Filters...'),$("#resetFilterToastBtn").prop("disabled",!0),$(".apply-filter-button").prop("disabled",!0),target_provinces=[],target_municipalities=[],target_areas=[],target_ages=[],target_genders=[],target_population_groups=[],target_generations=[],target_citizen_vs_residents=[],target_marital_statuses=[],target_home_owners=[],target_risk_categories=[],target_incomes=[],target_directors=[],target_vehicle_owners=[],target_lsm_groups=[],target_property_valuations=[],target_property_count_buckets=[],$("#province-filter-form input[type='checkbox']").each(function(){this.checked&&target_provinces.push($(this).val())}),$("#age-filter-form input[type='checkbox']").each(function(){this.checked&&target_ages.push($(this).val())}),$("#gender-filter-form input[type='checkbox']").each(function(){this.checked&&target_genders.push($(this).val())}),$("#population-group-filter-form input[type='checkbox']").each(function(){this.checked&&target_population_groups.push($(this).val())}),$("#generation-filter-form input[type='checkbox']").each(function(){this.checked&&target_generations.push($(this).val())}),$("#marital-status-filter-form input[type='checkbox']").each(function(){this.checked&&target_marital_statuses.push($(this).val())}),$("#home-owner-filter-form input[type='checkbox']").each(function(){this.checked&&target_home_owners.push($(this).val())}),$("#vehicle-owner-filter-form input[type='checkbox']").each(function(){this.checked&&target_vehicle_owners.push($(this).val())}),$("#property-valuation-filter-form input[type='checkbox']").each(function(){this.checked&&target_property_valuations.push($(this).val())}),$("#property-count-bucket-filter-form input[type='checkbox']").each(function(){this.checked&&target_property_count_buckets.push($(this).val())}),$("#lsm-group-filter-form input[type='checkbox']").each(function(){this.checked&&target_lsm_groups.push($(this).val())}),$("#risk-categories-filter-form input[type='checkbox']").each(function(){this.checked&&target_risk_categories.push($(this).val())}),$("#household-income-filter-form input[type='checkbox']").each(function(){this.checked&&target_incomes.push($(this).val())}),$("#directors-filter-form input[type='checkbox']").each(function(){this.checked&&target_directors.push($(this).val())}),$("#citizen-vs-resident-filter-form input[type='checkbox']").each(function(){this.checked&&target_citizen_vs_residents.push($(this).val())}),$("#municipality-filter-form input[type='checkbox']").each(function(){this.checked&&target_municipalities.push($(this).val())}),$("#area-filter-form input[type='checkbox']").each(function(){this.checked&&target_areas.push($(this).val())}),$("#provinceContactsId").val(target_provinces),$("#areaContactsId").val(target_areas),$("#municipalityContactsID").val(target_municipalities),$("#AgeContactsId").val(target_ages),$("#GenderContactsId").val(target_genders),$("#populationContactsId").val(target_population_groups),$("#generationContactsId").val(target_generations),$("#citizenVsResidentsContactsId").val(target_citizen_vs_residents),$("#maritalStatusContactsId").val(target_marital_statuses),$("#homeOwnerContactsId").val(target_home_owners),$("#riskCategoryContactsId").val(target_risk_categories),$("#houseHoldIncomeContactsId").val(target_incomes),$("#directorsContactsId").val(target_directors),$("#vehicleOwnerContactsId").val(target_vehicle_owners),$("#lsmGroupContactsId").val(target_lsm_groups),$("#propertyValuationContactsId").val(target_property_valuations),$("#propertyCountBucketContactsId").val(target_property_count_buckets),apply_filters(),get_provinces()}),$("#resetFilterToastBtn, #reset-toggle-button").click(function(){window.scrollTo(0,0),data_fetched=0,$("#progress_popup .progress-bar").width("0%"),$("#progress_popup").show(),checkForFilters(),$("#resetFilterToastBtn").prop("disabled",!0),$("#resetFilterToastBtn").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Resetting...'),$(".apply-filter-button, .apply-changes-button").prop("disabled",!0),$(".sidebar-filters ul li").remove(),$(".sidebar-filters ul").hide(),$("#no_filters").show(),target_provinces=[],target_municipalities=[],target_areas=[],target_ages=[],target_genders=[],target_population_groups=[],target_generations=[],target_citizen_vs_residents=[],target_marital_statuses=[],target_home_owners=[],target_risk_categories=[],target_incomes=[],target_directors=[],target_vehicle_owners=[],target_lsm_groups=[],target_property_valuations=[],target_property_count_buckets=[],$("#provinceContactsId").val(target_provinces),$("#areaContactsId").val(target_areas),$("#municipalityContactsID").val(target_municipalities),$("#AgeContactsId").val(target_ages),$("#GenderContactsId").val(target_genders),$("#populationContactsId").val(target_population_groups),$("#generationContactsId").val(target_generations),$("#citizenVsResidentsContactsId").val(target_citizen_vs_residents),$("#maritalStatusContactsId").val(target_marital_statuses),$("#homeOwnerContactsId").val(target_home_owners),$("#riskCategoryContactsId").val(target_risk_categories),$("#houseHoldIncomeContactsId").val(target_incomes),$("#directorsContactsId").val(target_directors),$("#vehicleOwnerContactsId").val(target_vehicle_owners),$("#lsmGroupContactsId").val(target_lsm_groups),$("#propertyValuationContactsId").val(target_property_valuations),$("#propertyCountBucketContactsId").val(target_property_count_buckets),$("input:checkbox").each(function(e){$(e).is(":checked")&&$(e).prop("checked",!1)}),apply_filters(),get_provinces()});var get_saved_audiences=function(){$("#btn_prev").off(),$("#btn_next").off(),$("#userSavedFiles").html('<div class="d-flex justify-content-center w-100"><div class="spinner-border" role="status"><span class="sr-only">Loading...</span></div></div>'),$.get("/api/meetpat-client/get-saved-audiences",{user_id:user_id_number},function(e){$("#userSavedFiles .d-flex").remove(),numPages(e)>=current_page?changePage(current_page,e):(changePage(current_page-1,e),current_page-=1)}).fail(function(e){console.log(e)}).done(function(e){e.length?($("#btn_prev").on("click",function(t){t.preventDefault(),current_page>1&&changePage(--current_page,e)}),$("#btn_next").on("click",function(t){t.preventDefault(),current_page<numPages(e)&&changePage(++current_page,e)})):$("#userSavedFiles").append('<div class="col-12">You haved not saved any audiences yet.</div>')})};$(document).ready(function(){set_records_count_progress_text(),get_saved_audiences(),$("#records-main-toast").toast("show"),$("#records-toast").toast("show"),$(".dropdown-menu, .dropdown-toggle").on("click",function(e){$(this).hasClass("dropdown-menu-form")&&e.stopPropagation()}),$("#SavedAudiencesModal").on("show.bs.modal",function(){$("#SaveAudienceModal").modal("hide"),toggle_side_bar()}),$("#SaveAudienceModal").on("show.bs.modal",function(){$("#SavedAudiencesModal").modal("hide"),$("#nameFile").val().length>1&&$("#nameFile").val().match(/^([A-z\_0-9])\w+$/g)?$("#downloadSubmitBtn").prop("disabled",!1):$("#downloadSubmitBtn").prop("disabled",!0),toggle_side_bar()}),$("#SavedAudiencesModal").on("hide.bs.modal",function(){toggle_side_bar()}),$("#SaveAudienceModal").on("hide.bs.modal",function(){toggle_side_bar()}),get_provinces(),$("#sidebar-toggle-button").click(function(){toggle_side_bar()}),$("#nameFile").on("input",function(){$("#nameFile").val().length>1&&$("#nameFile").val().match(/^([A-z\_0-9])\w+$/g)?($("#nameFile").removeClass("is-invalid"),$("#nameFile").addClass("is-valid"),$("#downloadSubmitBtn").prop("disabled",!1)):($("#nameFile").removeClass("is-valid"),$("#nameFile").addClass("is-invalid"),$("#downloadSubmitBtn").prop("disabled",!0))}),$("#downloadSubmitBtn").click(function(){if(file_name_exists($("#nameFile").val()))$("#SaveAudienceModal .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> You can\'t have a file with the same name.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>');else{$("#SaveAudienceModal .alerts").empty();var e={};$("#filtersForm").serializeArray().map(function(t){return e[t.name]=t.value}),e.file_name=$("#nameFile").val(),$("#downloadSubmitBtn").prop("disabled",!0),$("#downloadSubmitBtn").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Saving...'),$.post("/api/meetpat-client/filtered-audience/save",e,function(e){}).fail(function(e){$("#downloadSubmitBtn").prop("disabled",!1),$("#downloadSubmitBtn").html('<i class="far fa-save"></i>&nbsp;Save Contacts'),$("#savedAudiencesForm .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> There was an error saving file names. Please contact MeetPAT for support.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>'),$("#SavedAudiencesModal").modal("show"),console.log(e)}).done(function(e){var t=setInterval(function(){$.post("/api/meetpat-client/saved-file-job-status",{id:e.job.id},function(e){}).fail(function(e){console.log(e)}).done(function(e){"complete"==e.job.status&&(clearInterval(t),$("#downloadSubmitBtn").prop("disabled",!1),$("#downloadSubmitBtn").html('<i class="far fa-save"></i>&nbsp;Save Contacts'),$("#SavedAudiencesModal").modal("show"),get_saved_audiences())})},3e3)})}}),$("#saveFileNameEdits").click(function(){if(0==no_same_file_names().length){$("#savedAudiencesForm .alerts").empty();var e={},t=$(this),a=$("#btn_next_item").hasClass("disabled"),r=$("#btn_prev_item").hasClass("disabled");$("#savedAudiencesForm").serializeArray().map(function(t){return e[t.name]=t.value}),e.user_id=user_id_number,t.prop("disabled",!0),t.html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>&nbsp;Saving...'),a||$("#btn_next_item").addClass("disabled"),r||$("#btn_prev_item").addClass("disabled"),$(".delete_file_btn").prop("disabled",!0),$.post("/api/meetpat-client/save-filename-edits",e,function(e){$("#savedAudiencesForm .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> There was an error saving file names. Please contact MeetPAT for support.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}).fail(function(e){t.prop("disabled",!1),t.html("Save Changes"),a||$("#btn_next_item").removeClass("disabled"),r||$("#btn_prev_item").removeClass("disabled"),$(".delete_file_btn").prop("disabled",!1),t.prop("disabled",!1),t.html("Save Changes"),console.log(e)}).done(function(e){$(".delete_file_btn").prop("disabled",!1),a||$("#btn_next_item").removeClass("disabled"),r||$("#btn_prev_item").removeClass("disabled"),get_saved_audiences(),t.prop("disabled",!1),t.html("Save Changes"),$("#savedAudiencesForm .alerts").html('<div class="alert alert-success alert-dismissible fade show" role="alert"><strong>Success!</strong> File names updated successfully.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')})}else $("#savedAudiencesForm .alerts").html('<div class="alert alert-danger alert-dismissible fade show" role="alert"><strong>Error!</strong> You can\'t have files with the same name.<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button></div>')}),initial_scroll=145,window.addEventListener("scroll",function(){window.scrollY<120&&window.scrollY>0?$("#progress_popup").css({"padding-top":initial_scroll-window.scrollY+"px"}):window.scrollY>120?$("#progress_popup").css({"padding-top":"25px"}):(initial_scroll=145,$("#progress_popup").css({"padding-top":"145px"}))},!1)});